var G=Object.defineProperty,J=Object.defineProperties;var Y=Object.getOwnPropertyDescriptors;var P=Object.getOwnPropertySymbols;var K=Object.prototype.hasOwnProperty,X=Object.prototype.propertyIsEnumerable;var A=(r,t,a)=>t in r?G(r,t,{enumerable:!0,configurable:!0,writable:!0,value:a}):r[t]=a,p=(r,t)=>{for(var a in t||(t={}))K.call(t,a)&&A(r,a,t[a]);if(P)for(var a of P(t))X.call(t,a)&&A(r,a,t[a]);return r},h=(r,t)=>J(r,Y(t));import{l as Z,r as d,aA as x,a as e,j as s,S as ee,ax as I,aL as te,a0 as re,F as f}from"./index.js";import{c as oe,i as ae,r as ne}from"./jsx-runtime_commonjs-proxy.js";import{B as se}from"./Badge.js";import{D as T,B as ie,a as le}from"./DatePicker.js";import{d as ce,s as me}from"./Navbar.js";import{d as de}from"./Add.js";import{d as L}from"./string.helper.js";import{T as g}from"./Typography.js";import{S as M}from"./Stack.js";import{D as w}from"./Divider.js";import{T as _}from"./TextInput.js";import{T as ue}from"./TextEditor.js";import{c as D,b as S,d as pe,h as he,g as ge,o as fe,u as R,a as xe,C as ye,F as ve}from"./array.js";import{S as _e}from"./SelectHookForm.js";import{d as W,a as V}from"./CheckBoxOutlineBlank.js";import{A as H}from"./AutocompleteServer.js";import{C as j}from"./Checkbox.js";import{A as be}from"./Alert.js";import{L as Ce,c as Ne}from"./LoadingButton.js";import{u as Fe,S as Se,c as Ie,b as Me,d as Te,a as we}from"./base64.js";import{d as Oe}from"./Search.js";import{P as Be}from"./Menu.js";import{B as O}from"./Button.js";import{B as ze}from"./BootstrapTooltip.js";import{B as U}from"./Box.js";import{I as k}from"./InputAdornment.js";import{I as Pe}from"./IconButton.js";import{P as Ae}from"./Pagination.js";import{L as De}from"./LinearProgress.js";import"./createSvgIcon.js";import"./useControlled.js";import"./useIsFocusVisible.js";import"./isHostComponent.js";import"./Tooltip.js";import"./Portal.js";import"./Grow.js";import"./Close2.js";import"./MobileDatePicker.js";import"./MonthPicker.js";import"./usePickerState.js";import"./Grid.js";import"./extendSxProp.js";import"./ButtonBase.js";import"./Backdrop.js";import"./index7.js";import"./Paper.js";import"./Modal.js";import"./ContentProvider.js";import"./useModal.js";import"./jwt-decode.esm.js";import"./regex.js";import"./TextField.js";import"./FormHelperText.js";import"./react-is.production.min.js";import"./GlobalStyles.js";import"./upperFirst.js";import"./MenuItem.js";import"./List.js";import"./listItemIconClasses.js";import"./listItemTextClasses.js";import"./useFetch.js";import"./useHttpService.js";import"./Autocomplete.js";import"./Close.js";import"./Chip.js";var B={},ke=ae.exports;Object.defineProperty(B,"__esModule",{value:!0});var z=B.default=void 0,$e=ke(oe),Ee=ne,qe=(0,$e.default)((0,Ee.jsx)("path",{d:"m2.53 19.65 1.34.56v-9.03l-2.43 5.86c-.41 1.02.08 2.19 1.09 2.61zm19.5-3.7L17.07 3.98c-.31-.75-1.04-1.21-1.81-1.23-.26 0-.53.04-.79.15L7.1 5.95c-.75.31-1.21 1.03-1.23 1.8-.01.27.04.54.15.8l4.96 11.97c.31.76 1.05 1.22 1.83 1.23.26 0 .52-.05.77-.15l7.36-3.05c1.02-.42 1.51-1.59 1.09-2.6zM7.88 8.75c-.55 0-1-.45-1-1s.45-1 1-1 1 .45 1 1-.45 1-1 1zm-2 11c0 1.1.9 2 2 2h1.45l-3.45-8.34v6.34z"}),"Style");z=B.default=qe;const Le=Z(se)(({theme:r})=>({"& .MuiBadge-badge":{right:-1,top:7,border:`1.5px solid ${r.palette.background.paper}`,padding:"0 4px"}})),Re="_main_1yowg_1",We="_sidebar_1yowg_9",Ve="_pagination_1yowg_22",He="_searchInput_1yowg_35",je="_element_1yowg_42",Ue="_active_1yowg_63",Qe="_title_1yowg_67",Ge="_fechas_1yowg_71",Je="_fecha_1yowg_71",Ye="_subtitle_1yowg_91",Ke="_content_1yowg_109",Xe="_appbar_1yowg_117",Ze="_backButton_1yowg_130",et="_titulo_1yowg_137",tt="_parrafo_1yowg_158";var m={main:Re,sidebar:We,pagination:Ve,searchInput:He,element:je,active:Ue,title:Qe,fechas:Ge,fecha:Je,subtitle:Ye,content:Ke,appbar:Xe,backButton:Ze,titulo:et,parrafo:tt};const Q=()=>{const r=d.exports.useContext(x),{nota:t,setNota:a,showForm:o,setShowForm:l}=r;return e("div",{className:m.appbar,children:s("div",{className:m.backButton,onClick:()=>{l(t?!1:!o),a(null)},children:[e(ee,{component:!o&&!t?de:ce}),e("span",{children:t||o?"Atr\xE1s":"Agregar"})]})})},$=()=>{const{isPhoneScreen:r,nota:t}=d.exports.useContext(x);return s(g,{className:m.content,component:"div",children:[!r&&e(Q,{}),e("span",{className:m.titulo,children:t==null?void 0:t.titulo}),s("span",{className:m.fecha,children:[e("strong",{children:"Creada por"}),": ",t==null?void 0:t.nombre," ",t==null?void 0:t.apellido]}),(t==null?void 0:t.persona_encargada)&&s("span",{className:m.fecha,children:[e("strong",{children:"Persona con qui\xE9n se habl\xF3"}),": ",t==null?void 0:t.persona_encargada]}),s(M,{direction:{xs:"column",md:"row"},justifyContent:"space-between",children:[s("span",{className:m.fecha,children:[e("strong",{children:"Mes"}),": ",I(t==null?void 0:t.mes,"MMMM/yyyy")]}),s("span",{className:m.fecha,children:[e("strong",{children:"Fecha de creaci\xF3n"}),":"," ",I(t==null?void 0:t.fecha,"dd/MM/yyyy hh:mm aaaa")]})]}),e(w,{}),e("div",{className:m.parrafo,children:L(t==null?void 0:t.notas)})]})},rt=D().shape({titulo:S().trim().notRequired().nullable(!0),negocio:D().shape({id:pe().typeError("Favor ingresar un n\xFAmero").min(1,"Favor ingresar el negocio").integer("Favor ingresar el negocio").positive("Favor ingresar el negocio").required("Favor ingresar el negocio")}).typeError("Favor ingresar el negocio").required("Favor ingresar el negocio"),tipo:S().trim().required("Favor ingresar el tipo de la nota"),persona_encargada:S().trim().notRequired().nullable(!0),notas:S().trim().required("Favor ingresar la nota"),mes:he().typeError("Favor ingresar el mes").transform(te).required("Favor ingresar el mes")}),ot=r=>{const{negocioNota:t,pagination:a}=d.exports.useContext(x),{refresh:o}=a,l=re(),[,i]=l,n=ge({mode:"onSubmit",resolver:fe(rt),defaultValues:{mes:"",notas:"",persona_encargada:"",titulo:"",tipo:"",negocio:null}}),{reset:u,getValues:c}=n;return d.exports.useEffect(()=>{(()=>{u(p(p({},c()),t))})()},[t]),{onSubmit:y=>{var b;(b=r.current)==null||b.scrollTo(0,0),i("/admin/notas",{method:"POST",data:y}).then(C=>{C.data&&!C.error&&(o(),u(h(p({},y),{titulo:"",notas:"",persona_encargada:""})))})},fetcherSubmit:l,form:n}},at=()=>{var i;const{formState:r,control:t,setValue:a}=R(),{errors:o}=r,l=xe({control:t,name:"mes"});return s(M,{direction:{xs:"column",md:"row"},spacing:1,children:[e(_e,{label:"Tipo de nota",disableBox:!0,name:"tipo",values:["CONTRATO","DECIMO","F03","ITBMS","LIQUIDACION","SIPE"],options:["CONTRATO","DECIMO","F03","ITBMS","LIQUIDACION","SIPE"],required:!0,error:!!o.tipo,helperText:(i=o.tipo)==null?void 0:i.message,size:"small"}),e(T,{label:"Mes de la nota",views:["month","year"],inputFormat:"MM/yyyy",value:l,onChange:n=>a("mes",n),renderInput:n=>{var u;return e(_,h(p({size:"small",fullWidth:!0},n),{error:!!o.mes,helperText:(u=o.mes)==null?void 0:u.message}))}})]})},nt=()=>{const{control:r}=R();return e(ye,{name:"negocio",control:r,render:({field:t,fieldState:a})=>{const{error:o}=a,{onChange:l}=t;return e(H,h(p({},t),{ref:null,inputProps:{label:"Negocio",margin:"dense",required:!0,error:!!o,helperText:o==null?void 0:o.message},disableStyle:!0,onChange:(i,n)=>l(n),isOptionEqualToValue:(i,n)=>i.id===n.id,urlFetch:"/admin/negocios/autocomplete",size:"small",getOptionLabel:i=>`${i.tipo||""} ${i.nombre_negocio||""} - ${i.id}`,renderOption:(i,n,{selected:u})=>s("li",h(p({},i),{style:{textOverflow:"ellipsis",whiteSpace:"nowrap"},children:[e(j,{icon:e(W,{}),checkedIcon:e(V,{}),checked:u,size:"small"}),s("div",{style:{display:"flex",flexDirection:"column",textTransform:"uppercase"},children:[s(g,{variant:"body1",fontWeight:"bold",children:[n.tipo," ",n.nombre_negocio]}),n.ruc&&n.ruc!==""?e(g,{variant:"body2",children:n.ruc}):e(f,{}),n.ruta&&n.ruta!==""?s(g,{variant:"body2",children:["RUTA: ",n.ruta]}):e(f,{})]})]}))}))}})},E=()=>{var b,C;const r=d.exports.useRef(null),{onSubmit:t,fetcherSubmit:a,form:o}=ot(r),[l,,i,n]=a,{register:u,handleSubmit:c,formState:F}=o,{errors:y}=F;return e(ve,h(p({},o),{children:s(M,{spacing:1,flexGrow:1,direction:"column",padding:"0 10px 10px 10px",component:"form",sx:{overflowY:"auto"},ref:r,children:[e(g,{variant:"h4",textAlign:"center",children:"Formulario de notas"}),(i||n)&&e(be,{variant:"outlined",severity:i?"success":"error",children:(i==null?void 0:i.message)||(n==null?void 0:n.message)}),e(nt,{}),e(at,{}),s(M,{spacing:1,direction:{xs:"column",md:"row"},children:[e(_,h(p({label:"T\xEDtulo",size:"small",fullWidth:!0},u("titulo")),{error:!!y.titulo,helperText:(b=y.titulo)==null?void 0:b.message})),e(_,h(p({label:"Persona con quien se habl\xF3",size:"small",fullWidth:!0},u("persona_encargada")),{error:!!y.persona_encargada,helperText:(C=y.persona_encargada)==null?void 0:C.message}))]}),e(ue,{name:"notas",height:300}),e(Ce,{loading:l,loadingIndicator:"Enviando...",variant:"outlined",onClick:c(t),children:"Guardar"})]})}))},N=d.exports.createContext({}),st=({children:r})=>{const t=Fe(),{pagination:a}=d.exports.useContext(x),{params:o}=a,[l,i]=d.exports.useState({mes:(o==null?void 0:o.mes)||null,fecha:(o==null?void 0:o.fecha)||null,negocio:(o==null?void 0:o.negocio)||null,tipo:(o==null?void 0:o.tipo)||null});return e(N.Provider,{value:{menu:t,filtros:l,setFiltros:n=>i(n)},children:r})},it="_menu_19nmr_1",lt="_item_19nmr_8",ct="_action_19nmr_15";var v={menu:it,item:lt,action:ct};const mt=()=>{const{filtros:r,setFiltros:t}=d.exports.useContext(N);return e(Se,{label:"Tipo de nota",disableBox:!0,value:(r==null?void 0:r.tipo)||"",onChange:a=>t(h(p({},r),{tipo:a.target.value})),values:["CONTRATO","DECIMO","F03","ITBMS","LIQUIDACION","SIPE"],options:["CONTRATO","DECIMO","F03","ITBMS","LIQUIDACION","SIPE"],size:"small"})},dt=()=>{const{filtros:r,setFiltros:t}=d.exports.useContext(N);return e(H,{ref:null,fullWidth:!0,inputProps:{label:"Negocio",margin:"dense",fullWidth:!0},disableStyle:!0,value:r!=null&&r.negocio?JSON.parse(Ie(r==null?void 0:r.negocio)):null,onChange:(a,o)=>t(h(p({},r),{negocio:Me(JSON.stringify(o))})),isOptionEqualToValue:(a,o)=>a.id===o.id,urlFetch:"/admin/negocios/autocomplete",size:"small",getOptionLabel:a=>`${a.tipo||""} ${a.nombre_negocio||""} - ${a.id}`,renderOption:(a,o,{selected:l})=>s("li",h(p({},a),{style:{textOverflow:"ellipsis",whiteSpace:"nowrap"},children:[e(j,{icon:e(W,{}),checkedIcon:e(V,{}),checked:l,size:"small"}),s("div",{style:{display:"flex",flexDirection:"column",textTransform:"uppercase"},children:[s(g,{variant:"body1",fontWeight:"bold",children:[o.tipo," ",o.nombre_negocio]}),o.ruc&&o.ruc!==""?e(g,{variant:"body2",children:o.ruc}):e(f,{}),o.ruta&&o.ruta!==""?s(g,{variant:"body2",children:["RUTA: ",o.ruta]}):e(f,{})]})]}))})},ut=()=>{const{menu:r,filtros:t,setFiltros:a}=d.exports.useContext(N),{pagination:o}=d.exports.useContext(x),{setParams:l}=o,{anchorEl:i,handleClose:n,open:u}=r;return e(Be,{open:u,anchorEl:i,onClose:n,anchorOrigin:{vertical:"bottom",horizontal:"left"},children:s("div",{className:v.menu,children:[e("div",{className:v.item,children:e(T,{label:"Mes de la nota",views:["month","year"],inputFormat:"MM/yyyy",value:t.mes,onChange:c=>a(h(p({},t),{mes:c})),renderInput:c=>e(_,p({size:"small",fullWidth:!0},c))})}),e("div",{className:v.item,children:e(T,{label:"Fecha de creaci\xF3n",value:t.fecha,inputFormat:"dd/MM/yyyy",onChange:c=>a(h(p({},t),{fecha:c})),renderInput:c=>e(_,p({size:"small",fullWidth:!0},c))})}),e("div",{className:v.item,children:e(mt,{})}),e("div",{className:v.item,children:e(dt,{})}),s("div",{className:v.action,children:[e(O,{variant:"outlined",color:"inherit",onClick:()=>n(),children:"Cerrar"}),e(O,{variant:"outlined",color:"primary",onClick:()=>{l(t),n()},children:"Filtrar"})]})]})})},pt=()=>{const{menu:r}=d.exports.useContext(N),{pagination:t}=d.exports.useContext(x),{search:a,sendSearch:o}=t,{handleClick:l}=r,[i,n]=d.exports.useState(a),u=c=>{c.preventDefault();const F=Object.fromEntries(new FormData(c.currentTarget));o(F.q)};return s("form",{className:m.searchInput,onSubmit:u,children:[e(_,{variant:"standard",type:"text",name:"q",value:i,placeholder:"Buscar...",fullWidth:!0,size:"small",onChange:c=>n(c.target.value),InputProps:{endAdornment:s(U,{display:"flex",alignItems:"center",children:[e(k,{position:"end",children:e(Oe,{})}),e(k,{position:"end",children:e(ze,{title:"Filtros",placement:"top",children:e(Pe,{size:"small",onClick:l,children:e(Te,{})})})})]})}}),e(ut,{})]})},ht=()=>{const{pagination:r}=d.exports.useContext(x),{fetcher:t,page:a,setPage:o}=r,[,,l]=t;return!l||l&&!l.paginas?e(f,{}):e("div",{className:m.pagination,children:e(Ae,{color:"primary",count:l==null?void 0:l.paginas,page:a,onChange:(i,n)=>o(n)})})},gt=({label:r,width:t,height:a})=>s(we,{children:[e("svg",{width:t||"120",height:a||"100",viewBox:"0 0 184 152","aria-hidden":!0,focusable:"false",children:s("g",{fill:"none",fillRule:"evenodd",children:[s("g",{transform:"translate(24 31.67)",children:[e("ellipse",{className:"ant-empty-img-5",cx:"67.797",cy:"106.89",rx:"67.797",ry:"12.668"}),e("path",{className:"ant-empty-img-1",d:"M122.034 69.674L98.109 40.229c-1.148-1.386-2.826-2.225-4.593-2.225h-51.44c-1.766 0-3.444.839-4.592 2.225L13.56 69.674v15.383h108.475V69.674z"}),e("path",{className:"ant-empty-img-2",d:"M33.83 0h67.933a4 4 0 0 1 4 4v93.344a4 4 0 0 1-4 4H33.83a4 4 0 0 1-4-4V4a4 4 0 0 1 4-4z"}),e("path",{className:"ant-empty-img-3",d:"M42.678 9.953h50.237a2 2 0 0 1 2 2V36.91a2 2 0 0 1-2 2H42.678a2 2 0 0 1-2-2V11.953a2 2 0 0 1 2-2zM42.94 49.767h49.713a2.262 2.262 0 1 1 0 4.524H42.94a2.262 2.262 0 0 1 0-4.524zM42.94 61.53h49.713a2.262 2.262 0 1 1 0 4.525H42.94a2.262 2.262 0 0 1 0-4.525zM121.813 105.032c-.775 3.071-3.497 5.36-6.735 5.36H20.515c-3.238 0-5.96-2.29-6.734-5.36a7.309 7.309 0 0 1-.222-1.79V69.675h26.318c2.907 0 5.25 2.448 5.25 5.42v.04c0 2.971 2.37 5.37 5.277 5.37h34.785c2.907 0 5.277-2.421 5.277-5.393V75.1c0-2.972 2.343-5.426 5.25-5.426h26.318v33.569c0 .617-.077 1.216-.221 1.789z"})]}),e("path",{className:"ant-empty-img-3",d:"M149.121 33.292l-6.83 2.65a1 1 0 0 1-1.317-1.23l1.937-6.207c-2.589-2.944-4.109-6.534-4.109-10.408C138.802 8.102 148.92 0 161.402 0 173.881 0 184 8.102 184 18.097c0 9.995-10.118 18.097-22.599 18.097-4.528 0-8.744-1.066-12.28-2.902z"}),s("g",{className:"ant-empty-img-4",transform:"translate(149.65 15.383)",children:[e("ellipse",{cx:"20.654",cy:"3.167",rx:"2.849",ry:"2.815"}),e("path",{d:"M5.698 5.63H0L2.898.704zM9.259.704h4.985V5.63H9.259z"})]})]})}),e(U,{sx:{mt:1,textTransform:"uppercase",fontWeight:"bold"},children:r?e(f,{children:r}):e(f,{children:"Sin resultado"})})]}),q=()=>{var u;const{pagination:r,nota:t,setNota:a}=d.exports.useContext(x),{fetcher:o}=r,[l,,i,n]=o;return s("div",{className:m.sidebar,children:[s("div",{children:[e(st,{children:e(pt,{})}),l&&e(De,{}),n&&e(gt,{label:n.message}),e("ul",{children:(u=i==null?void 0:i.resultados)==null?void 0:u.map(c=>s(g,{component:"li",className:`${m.element} ${(t==null?void 0:t.id)===c.id&&m.active}`,onClick:()=>a(c),children:[e("span",{className:m.title,children:c.titulo}),e("div",{className:m.subtitle,children:L(c.notas)}),s("div",{className:m.fechas,children:[e("span",{className:m.fecha,children:I(c.mes,"MM/yyyy")}),e("span",{className:m.fecha,children:I(c.fecha,"dd/MM/yyyy HH:mm aaaa")})]})]},c.id))})]}),e(ht,{})]})},ft=()=>{const{isPhoneScreen:r,nota:t,showForm:a}=d.exports.useContext(x);return e("section",{className:m.main,children:r?s(f,{children:[e(Q,{}),!t&&!a&&e(q,{}),a&&e(E,{}),t&&!a&&e($,{})]}):s(f,{children:[e(q,{}),!t&&e(E,{}),t&&e($,{})]})})},xt=()=>{const{modalNotas:r,isPhoneScreen:t}=d.exports.useContext(x),[a,o]=r;return e(f,{children:s(ie,{open:a,onClose:()=>o(!1),maxWidth:"xl",fullWidth:!0,fullScreen:t,children:[e(le,{onClose:()=>o(!1),children:s(g,{textTransform:"uppercase",display:"flex",flexDirection:"row",gap:1,alignItems:"center",children:[e(z,{}),"Notas"]})}),e(w,{}),e(ft,{}),e(w,{}),e(Ne,{children:e(O,{variant:"outlined",color:"inherit",onClick:()=>o(!1),children:"Cerrar"})})]})})},Or=()=>{const{modalNotas:r}=d.exports.useContext(x),[,t]=r;return s(f,{children:[s(g,{className:me.buttonIcon,onClick:()=>t(!0),variant:"body2",children:[e("span",{children:"Notas"})," ",e(Le,{badgeContent:0,color:"error",max:99,children:e(z,{})})]}),e(xt,{})]})};export{Or as default};
