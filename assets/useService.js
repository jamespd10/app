import{r as p,A as f}from"./index.js";import{B as m,A as x,O as S}from"./constants.js";const A=()=>{const{authState:o}=p.exports.useContext(f);return async(n,{method:c,data:u,params:t,signal:r,isBlob:i})=>{const{token:l}=o,s=new URL(m+n);if(t)for(const e of Object.keys(t))t[e]!==null&&s.searchParams.append(e,t[e]);try{const e=await fetch(s.toString(),{method:c,credentials:"include",mode:"cors",body:JSON.stringify(u),headers:new Headers({"Content-Type":"application/json","x-api-key":x,"x-token":l||"","Access-Control-Allow-Origin":S}),signal:r});if(e.ok&&e.status===201)return{data:i?await e.blob():await e.json(),error:null};if(e.status===200)return{data:null,error:{status:e.status,message:"Sin mensaje de error"}};{const a=await e.text(),d=JSON.parse(a);return{data:null,error:{status:e.status,message:d.message}}}}catch{return r!=null&&r.aborted?{data:null,error:{status:-1,message:"Se cancel\xF3 el env\xEDo de la solicitud"}}:{data:null,error:{status:-1,message:"Ocurri\xF3 un error inesperado"}}}}};export{A as u};
