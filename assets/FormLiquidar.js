var j=Object.defineProperty,I=Object.defineProperties;var O=Object.getOwnPropertyDescriptors;var k=Object.getOwnPropertySymbols;var W=Object.prototype.hasOwnProperty,V=Object.prototype.propertyIsEnumerable;var C=(e,r,t)=>r in e?j(e,r,{enumerable:!0,configurable:!0,writable:!0,value:t}):e[r]=t,F=(e,r)=>{for(var t in r||(r={}))W.call(r,t)&&C(e,t,r[t]);if(k)for(var t of k(r))V.call(r,t)&&C(e,t,r[t]);return e},M=(e,r)=>I(e,O(r));import{u as G,F as H}from"./yup.module.js";import{c as q,a as f,f as S,d as h,e as $}from"./array.js";import{d as b,i as P}from"./regex.js";import{q as D,d as E}from"./constantsLists.js";import Q from"./StepperForm.js";import{u as z}from"./useStepper.js";import{r as y,a,j as _,b as U,q as J,a2 as K,F as w,a7 as X}from"./index.js";import"./BootstrapTooltip.js";import"./ContentProvider.js";import"./SpeedDial.module.js";import{B as Y}from"./BackgroundLoader.js";import"./SelectedCard.js";import{F as N}from"./FadeDisappearGrid.js";import{D as Z}from"./DateInput.js";import{D as v}from"./DecimalInput.js";import{S as B}from"./SelectHookForm.js";import{T as ee}from"./TextInput.js";import{g as R}from"./date.helper.js";import{G as l}from"./Grid.js";import{s as ae}from"./index30.js";import{u as re}from"./useFirstFetch.js";import{L as ie}from"./Loader.js";import oe from"./Modal.js";import{C as te}from"./Card.js";import"./upperFirst.js";import"./Typography.js";import"./Box.js";import"./createSvgIcon.js";import"./Button.js";import"./ButtonBase.js";import"./emotion-react.browser.esm.js";import"./useIsFocusVisible.js";import"./Tooltip.js";import"./Popper.js";import"./Portal.js";import"./useControlled.js";import"./isHostComponent.js";import"./Grow.js";import"./useModal.js";import"./Close2.js";import"./jsx-runtime_commonjs-proxy.js";import"./ModalTransition.js";import"./Backdrop.js";import"./Modal2.js";import"./Paper.js";import"./IconButton.js";import"./CheckCircle.js";import"./DialogContent.js";import"./LoadingButton.js";import"./CircularProgress.js";import"./useFetch.js";import"./useHttpService.js";import"./DatePicker.js";import"./MobileDatePicker.js";import"./MonthPicker.js";import"./PureDateInput.js";import"./CalendarPicker.js";import"./InputAdornment.js";import"./TextField.js";import"./react-is.production.min.js";import"./List.js";import"./GlobalStyles.js";import"./index11.js";import"./CustomDecimal.js";import"./react-number-format.es.js";import"./string.helper.js";import"./MenuItem.js";import"./listItemIconClasses.js";import"./Divider.js";import"./listItemTextClasses.js";import"./useAsyncRetry.js";import"./useAsync.js";const se=q().shape({motivo:f().trim().required("Favor seleccionar el motivo de liquidaci\xF3n").test("check-list","Favor seleccionar un motivo de la lista",e=>!!(e&&D.includes(e))),fecha_ini:S().typeError("Favor de seleccionar la fecha de inicio").required("Favor de seleccionar la fecha de inicio"),fecha_liquidacion:S().typeError("Favor de seleccionar la fecha de liquidaci\xF3n").required("Favor de seleccionar la fecha de liquidaci\xF3n"),is_total_salarios:f().trim().required("Favor seleccione si el usuario ingresa los salarios por mes o d\xE1 el total").test("check-decision","Favor seleccionar si o no",e=>!!(e&&E.includes(e))),total_suma_salarios:h().transform((e,r)=>r===""?null:e).nullable().when("is_total_salarios",{is:"Si",then:h().typeError("Favor ingresar la suma de salarios").positive("Favor ingresar un n\xFAmero positivo").min(1,"Favor ingresar la suma de salarios").max(9e10,"Favor ingresar un n\xFAmero de m\xE1ximo 10 d\xEDgitos").test("check-decimal","Favor ingresar m\xE1ximo dos decimales",e=>!!(e&&e.toString().match(b)))}),salario_mensual_termino:h().typeError("Favor de ingresar un n\xFAmero").positive("Favor de ingresar un n\xFAmero positivo").required("Favor de ingresar el salario mensual").min(1,"Favor ingresar el salario mensual").max(9e10,"Favor ingresar un n\xFAmero de m\xE1ximo 10 d\xEDgitos").test("check-decimal","Favor ingresar m\xE1ximo dos decimales",e=>!!(e&&e.toString().match(b))),observacion:f().trim().nullable(!0).test("check-str","Favor ingresar solo caracteres del abecedario y/o n\xFAmeros",e=>!(e&&!e.match(P)))}),ne=q().shape({total_salarios:$().nullable().when("is_total_salarios",{is:"No",then:$().typeError("Favor ingresar los salarios mensuales").of(q().shape({salario:h().typeError("Favor de ingresar la cantidad del salario").positive("La cantidad del salario debe ser positiva").min(.1,"La cantidad del salario debe ser mayor a 0").max(9e10,"Favor ingresar un n\xFAmero de m\xE1ximo 10 d\xEDgitos").required("Favor de ingresar la cantidad del salario").test("check-decimal","Favor ingresar m\xE1ximo dos decimales",e=>!!(e&&e.toString().match(b))),mes:S().typeError("Favor ingresar el mes del salario").required("Favor ingresar el mes del salario"),id_sal:h().transform((e,r)=>r===""?null:e).typeError("Favor ingresar un n\xFAmero").nullable(!0).integer("Favor ingresar un n\xFAmero entero").positive("Favor ingresar un n\xFAmero positivo")})).required("Favor ingresar los salarios mensuales")})}),le=()=>{var s,i;const{formState:{errors:e},watch:r,setValue:t}=G(),o=r("fecha_liquidacion"),m=r("is_total_salarios"),d=r("salario_segunda_quincena1"),c=r("salario_segunda_quincena2");return y.exports.useEffect(()=>{(()=>{t("salario_segunda_quincena",d+([3,7,11].includes(new Date(o).getMonth())&&new Date(o).getDate()<15?c:0))})()},[d,c,o,t]),a(N,{show:!!(o&&m==="No"),item:!0,xs:"auto",children:_(l,{container:!0,spacing:1,children:[a(l,{item:!0,xs:12,sm:[3,7,11].includes(new Date(o).getMonth())&&new Date(o).getDate()<15?6:12,children:a(v,{name:"salario_segunda_quincena1",label:`Salario de \xFAltima quincena de ${R([3,7,11].includes(new Date(o).getMonth())&&new Date(o).getDate()<15?ae(new Date(o),4):o)}`,fullWidth:!0,error:!!e.salario_segunda_quincena,helperText:(s=e.salario_segunda_quincena)==null?void 0:s.message,required:!0})}),[3,7,11].includes(new Date(o).getMonth())&&new Date(o).getDate()<15&&a(l,{item:!0,xs:12,sm:6,children:a(v,{name:"salario_segunda_quincena2",label:`Salario de \xFAltima quincena de ${R(o)}`,fullWidth:!0,error:!!e.salario_segunda_quincena,helperText:(i=e.salario_segunda_quincena)==null?void 0:i.message,required:!0})})]})})},me=y.exports.lazy(()=>U(()=>import("./TotalSalarios.js"),["assets/TotalSalarios.js","assets/index.js","assets/index11.css","assets/yup.module.js","assets/DecimalInput.js","assets/TextInput.js","assets/TextField.js","assets/useControlled.js","assets/react-is.production.min.js","assets/Modal2.js","assets/Backdrop.js","assets/isHostComponent.js","assets/Portal.js","assets/Paper.js","assets/Grow.js","assets/List.js","assets/createSvgIcon.js","assets/GlobalStyles.js","assets/emotion-react.browser.esm.js","assets/CustomDecimal.js","assets/react-number-format.es.js","assets/string.helper.js","assets/regex.js","assets/CircularProgress.js","assets/date.helper.js","assets/index30.js","assets/Grid.js","assets/Typography.js"])),de=({id:e,fecha_ini:r})=>{var g,x,p,L,T,A;const{loading:t,value:o}=re({url:`/admin/contratos/${e}/salarios`}),m=J(),d=K(m.breakpoints.down("lg")),{register:c,formState:{errors:s},watch:i,control:u}=G(),n=i("is_total_salarios");return a(w,{children:_(l,{container:!0,spacing:1,direction:"row",wrap:"wrap",sx:{"& > :not(style)":{flexGrow:1}},children:[a(l,{item:!0,xs:12,sm:6,md:4,lg:n==="Si"?4:3,children:a(B,{control:u,label:"Motivo de liquidaci\xF3n",options:D,values:D,error:!!s.motivo,helperText:(g=s.motivo)==null?void 0:g.message,name:"motivo",required:!0})}),a(l,{item:!0,xs:12,sm:6,md:4,lg:n==="Si"?4:3,children:a(v,{name:"salario_mensual_termino",label:"Salario mensual al t\xE9rmino de labores",fullWidth:!0,error:!!s.salario_mensual_termino,helperText:(x=s.salario_mensual_termino)==null?void 0:x.message,required:!0})}),a(l,{item:!0,xs:12,sm:6,md:4,lg:n==="Si"?4:3,children:a(Z,{label:"Fecha de liquidaci\xF3n",name:"fecha_liquidacion",error:!!s.fecha_liquidacion,helperText:(p=s.fecha_liquidacion)==null?void 0:p.message,required:!0,minDate:new Date(r)})}),a(l,{item:!0,xs:12,sm:6,md:n==="Si"?6:12,lg:n==="Si"?6:3,children:a(B,{control:u,label:"\xBFEl cliente d\xE1 la suma de salarios?",options:E,values:E,error:!!s.is_total_salarios,helperText:(L=s.is_total_salarios)==null?void 0:L.message,name:"is_total_salarios",required:!0})}),a(N,{show:n==="Si",item:!0,xs:12,sm:d?12:6,md:n==="Si"?6:12,children:a(v,{name:"total_suma_salarios",label:"Total de salarios",fullWidth:!0,error:!!s.total_suma_salarios,helperText:(T=s.total_suma_salarios)==null?void 0:T.message,required:!0})}),a(le,{}),!t&&a(y.exports.Suspense,{fallback:a(ie,{}),children:a(me,{salarios:o==null?void 0:o.data})}),a(l,{item:!0,xs:12,children:a(ee,F({label:"Observaci\xF3n",fullWidth:!0,multiline:!0,rows:4,error:!!s.observacion,helperText:(A=s.observacion)==null?void 0:A.message},c("observacion")))})]})})},Aa=e=>{var p;const r=X(),t=se.concat(ne),{activeStep:o,form:m,handleBack:d,handleNextStep:c,isLoading:s,res:i,modalState:u,setHide:n,handleSubmit:g,modalError:x}=z({schema:t,fields:[{names:Object.keys(t.fields)}],url:`/admin/contratos/${e.id}/liquidar`,defaultValues:{fecha_ini:e.fecha_ini,total_yy:e.total_yy}});return _(w,{children:[a(te,{variant:"outlined",sx:{p:1},children:a(H,M(F({},m),{children:a(Q,{activeStep:o,handleBack:d,sendLabel:"Liquidar",sentLabel:"Liquidado",disabledLast:!0,sentLabelImage:"Contrato liquidado!",steps:["Datos generales"],state:x,handleNext:c,errors:Object.keys(m.formState.errors).length,children:[a(de,F({},e),"Datos-generales")]})}))}),a(Y,{open:s}),a(oe,{state:u,title:"\xA1Atenci\xF3n!",setHide:i&&i.status===201?n:void 0,body:i?i&&i.status!==201?(p=i.error)==null?void 0:p.message:void 0:"\xBFRealmente desea liquidar el contrato?",cancelBotton:{actionFunction:n,text:i?"Cerrar":"Cancelar"},type:i&&i.status===201?"SUCCESS":"ERROR",actionButton:i?i&&i.status===201?{actionFunction:()=>{r(`/liquidaciones/${e.id}`,{replace:!0})},text:"Ver"}:void 0:{actionFunction:g,text:"Liquidar"},children:i&&i.status===201&&i.data?_(w,{children:[i.data.message,". ",a("br",{}),"\xBFDesea ver el contrato liquidado?"]}):void 0})]})};export{Aa as default};
