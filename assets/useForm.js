var P=Object.defineProperty,U=Object.defineProperties;var B=Object.getOwnPropertyDescriptors;var E=Object.getOwnPropertySymbols;var T=Object.prototype.hasOwnProperty,K=Object.prototype.propertyIsEnumerable;var S=(t,n,s)=>n in t?P(t,n,{enumerable:!0,configurable:!0,writable:!0,value:s}):t[n]=s,i=(t,n)=>{for(var s in n||(n={}))T.call(n,s)&&S(t,s,n[s]);if(E)for(var s of E(n))K.call(n,s)&&S(t,s,n[s]);return t},b=(t,n)=>U(t,B(n));import{r as y}from"./index.js";import{f as w,u as C}from"./object.helper.js";const R=(t,n,s,e,a)=>n?b(i({},s[t]),{types:b(i({},s[t]&&s[t].types?s[t].types:{}),{[e]:a||!0})}):{},g=(t,n)=>(t.inner||[]).reduce((s,e)=>{if(s[e.path]||(s[e.path]={message:e.message,type:e.type}),n){const a=s[e.path].types,c=a&&a[e.type];s[e.path]=R(e.path,n,s,e.type,c?[].concat(c,e.message):e.message)}return s},{}),F=t=>Array.isArray(t)?t.filter(Boolean):[],$=t=>F(t.replace(/["|']|\]/g,"").split(/\.|\[/)),k=t=>t===void 0,N=t=>t==null,j=t=>t instanceof Date,q=t=>typeof t=="object",V=t=>!N(t)&&!Array.isArray(t)&&q(t)&&!j(t),z=t=>/^\w*$/.test(t);var O=(t,n,s)=>{if(!n||!V(t))return s;const e=F(n.split(/[,[\].]+?/)).reduce((a,c)=>N(a)?a:a[c],t);return k(e)||e===t?k(t[n])?s:t[n]:e};function G(t,n,s){let e=-1;const a=z(n)?[n]:$(n),c=a.length,x=c-1;for(;++e<c;){const d=a[e];let m=s;if(e!==x){const p=t[d];m=V(p)||Array.isArray(p)?p:isNaN(+a[e+1])?{}:[]}t[d]=m,t=t[d]}return t}const A=(t,n,s)=>{if(t&&"reportValidity"in t){const e=O(s,n);t.setCustomValidity(e&&e.message||""),t.reportValidity()}},H=(t,n)=>{for(const s in n.fields){const e=n.fields[s];e&&e.ref&&"reportValidity"in e.ref?A(e.ref,s,t):e.refs&&e.refs.forEach(a=>A(a,s,t))}},h=(t,n)=>{n.shouldUseNativeValidation&&H(t,n);const s={};for(const e in t){const a=O(n.fields,e);G(s,e,Object.assign(t[e],{ref:a&&a.ref}))}return s},Q=(t,n)=>{const[s,e]=y.exports.useState(t),[a,c]=y.exports.useState({}),x=y.exports.useCallback(async({target:l})=>{try{const{name:o,value:r}=l,f=o.includes("."),u=f?w(s):s;o in u&&(u[o]=r);const I=f?C(u):u;e(i({},I))}catch(o){c(r=>i(i({},r),h(g(o,!1),{})))}},[s]),d=y.exports.useCallback(()=>{e(i({},t)),c({})},[t]),m=y.exports.useCallback(async({target:l})=>{try{const{value:o,name:r}=l;await n.validateAt(r,o,{abortEarly:!1})}catch(o){c(r=>i(i({},r),h(g(o,!1),{})))}},[n]),p=y.exports.useCallback(async l=>{try{await n.validate(s,{abortEarly:!1}),l(s),c({})}catch(o){c(h(g(o,!1),{}))}},[s,n]),D=y.exports.useCallback(async(l,o)=>{try{const r=l.includes("."),f=r?w(s):s;l in f&&(f[l]=o);const u=r?C(f):f;e(i({},u))}catch(r){c(f=>i(i({},f),h(g(r,!1),{})))}},[s]);return{formState:s,onInputChange:x,onInputBlur:m,onResetForm:d,onFormSubmit:p,errors:a,setValue:D,setFormState:e}};export{Q as u};
