var B=Object.defineProperty,O=Object.defineProperties;var T=Object.getOwnPropertyDescriptors;var F=Object.getOwnPropertySymbols;var W=Object.prototype.hasOwnProperty,z=Object.prototype.propertyIsEnumerable;var R=(e,t,o)=>t in e?B(e,t,{enumerable:!0,configurable:!0,writable:!0,value:o}):e[t]=o,A=(e,t)=>{for(var o in t||(t={}))W.call(t,o)&&R(e,o,t[o]);if(F)for(var o of F(t))z.call(t,o)&&R(e,o,t[o]);return e},I=(e,t)=>O(e,T(t));import{r as C,a as m,j as s,F as E}from"./index.js";import{D as P}from"./DecimalInput.js";import{u as j,e as w,j as q}from"./array.js";import{s as y}from"./formulario.module.js";import{A as G}from"./AutocompleteServer.js";import{a as D}from"./itbmsSchema.js";import{c as L}from"./fields.module2.js";import{f as M}from"./string.helper.js";import{B as S}from"./Button.js";import"./TextInput.js";import"./TextField.js";import"./useControlled.js";import"./react-is.production.min.js";import"./Modal2.js";import"./Backdrop.js";import"./isHostComponent.js";import"./Portal.js";import"./Paper.js";import"./Grow.js";import"./List.js";import"./createSvgIcon.js";import"./GlobalStyles.js";import"./emotion-react.browser.esm.js";import"./CustomDecimal.js";import"./react-number-format.es.js";import"./CircularProgress.js";import"./upperFirst.js";import"./useFetch.js";import"./useHttpService.js";import"./Autocomplete.js";import"./Close.js";import"./IconButton.js";import"./ButtonBase.js";import"./useIsFocusVisible.js";import"./Popper.js";import"./Chip.js";import"./regex.js";import"./Lazy.js";const U="_title_1es5p_1",H="_flexColumn_1es5p_11",J="_flexRow_1es5p_16",K="_subtitle_1es5p_23";var b={title:U,flexColumn:H,flexRow:J,subtitle:K};const Q=({i:e,k:t})=>{var l,u,g,h,f,_,x,$,v;const{editable:o}=C.exports.useContext(D),{formState:N,setValue:r,control:V}=j(),d=w({control:V,name:`negocios.${e}.retenciones.${t}`}),{errors:a}=N,[c,p]=C.exports.useState(d?{agente:d.agente,dv:d.dv,id:d.id_agente_retenedor,id_tipo:0,ruc:d.ruc,tipo:""}:null);return m(G,{ref:null,urlFetch:"/admin/agentes-retenedores",inputProps:{label:"Agente retenedor",error:!!((h=(g=(u=(l=a==null?void 0:a.negocios)==null?void 0:l[e])==null?void 0:u.retenciones)==null?void 0:g[t])!=null&&h.id_agente_retenedor),helperText:(v=($=(x=(_=(f=a==null?void 0:a.negocios)==null?void 0:f[e])==null?void 0:_.retenciones)==null?void 0:x[e])==null?void 0:$.id_agente_retenedor)==null?void 0:v.message},disableStyle:!0,enableFirst:!0,value:c,size:"small",disabled:!o,fullWidth:!0,onChange:(n,i)=>{p(i),i?(r(`negocios.${e}.retenciones.${t}.id_agente_retenedor`,i.id,{shouldValidate:!0}),r(`negocios.${e}.retenciones.${t}.agente`,i.agente,{shouldValidate:!0}),r(`negocios.${e}.retenciones.${t}.ruc`,i.ruc,{shouldValidate:!0}),r(`negocios.${e}.retenciones.${t}.dv`,i.dv,{shouldValidate:!0})):(r(`negocios.${e}.retenciones.${t}.id_agente_retenedor`,null,{shouldValidate:!0}),r(`negocios.${e}.retenciones.${t}.agente`,null,{shouldValidate:!0}),r(`negocios.${e}.retenciones.${t}.ruc`,null,{shouldValidate:!0}),r(`negocios.${e}.retenciones.${t}.dv`,null,{shouldValidate:!0}))},groupBy:n=>n.tipo,getOptionLabel:n=>n.agente,renderGroup:n=>s("div",{children:[s("div",{className:b.title,children:["Categor\xEDa: ",m("span",{children:n.group})]}),n.children]},n.key),renderOption:(n,i)=>C.exports.createElement("li",I(A({},n),{key:i.id}),s("div",{className:b.flexColumn,children:[m("span",{children:i.agente}),s("div",{className:b.flexRow,children:[s("span",{className:b.subtitle,children:["RUC: ",i.ruc]}),s("span",{className:b.subtitle,children:["DV: ",i.dv]})]})]}))})},Oe=({i:e})=>{const{editable:t}=C.exports.useContext(D),{control:o,formState:N}=j(),{fields:r,append:V,remove:d}=q({control:o,name:`negocios.${e}.retenciones`,keyName:"key"}),a=w({control:o,name:`negocios.${e}.retenciones`}),{errors:c}=N;return s("div",{className:`${y.paper} ${y.item}`,children:[m("span",{className:y.titleItem,children:"Retenciones"}),r.map((p,l)=>{var u,g,h,f,_,x,$,v,n;return s("div",{className:L.field,children:[m(Q,{i:e,k:l}),m(P,{label:"Total de retenciones",name:`negocios.${e}.retenciones.${l}.valor`,size:"small",fullWidth:!0,required:!0,error:!!((f=(h=(g=(u=c==null?void 0:c.negocios)==null?void 0:u[e])==null?void 0:g.retenciones)==null?void 0:h[l])!=null&&f.valor),helperText:(n=(v=($=(x=(_=c==null?void 0:c.negocios)==null?void 0:_[e])==null?void 0:x.retenciones)==null?void 0:$[l])==null?void 0:v.valor)==null?void 0:n.message,InputProps:{readOnly:!t}})]},p.key)}),s("span",{className:y.titleItem,children:["total de retenciones"," ",M(a.map(p=>Number(p.valor||0)).reduce((p,l)=>p+l))]}),!!t&&s(E,{children:[m(S,{variant:"contained",color:"primary",onClick:()=>V({valor:"",agente:"",dv:"",id_agente_retenedor:null,ruc:""}),children:"Agregar retenci\xF3n"}),r.length>1&&m(S,{variant:"contained",color:"error",onClick:()=>d(-1),children:"Remover \xFAltima retenci\xF3n"})]})]})};export{Oe as default};
