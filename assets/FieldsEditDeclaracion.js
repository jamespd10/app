var N=Object.defineProperty,R=Object.defineProperties;var q=Object.getOwnPropertyDescriptors;var S=Object.getOwnPropertySymbols;var J=Object.prototype.hasOwnProperty,K=Object.prototype.propertyIsEnumerable;var z=(m,r,t)=>r in m?N(m,r,{enumerable:!0,configurable:!0,writable:!0,value:t}):m[r]=t,u=(m,r)=>{for(var t in r||(r={}))J.call(r,t)&&z(m,t,r[t]);if(S)for(var t of S(r))K.call(r,t)&&z(m,t,r[t]);return m},x=(m,r)=>R(m,q(r));import{u as O,c as Q}from"./yup.module.js";import{D as M}from"./DecimalInput.js";import{T as h}from"./TextInput.js";import{C as U}from"./CustomDecimal.js";import{S as V}from"./SelectHookForm.js";import{f as w}from"./string.helper.js";import{_ as X}from"./usePrevious.js";import{r as Y,j,F as Z,a as i}from"./index.js";import{C as L}from"./CustomTable.js";import{G as s}from"./Grid.js";import{I as tt}from"./InputAdornment.js";import{B as G}from"./Button.js";import"./CircularProgress.js";import"./emotion-react.browser.esm.js";import"./TextField.js";import"./useFormControl.js";import"./useControlled.js";import"./useId.js";import"./formControlState.js";import"./react-is.production.min.js";import"./Modal2.js";import"./Backdrop.js";import"./Fade.js";import"./isHostComponent.js";import"./Portal.js";import"./Paper.js";import"./Grow.js";import"./List.js";import"./createSvgIcon.js";import"./outlinedInputClasses.js";import"./GlobalStyles.js";import"./react-number-format.es.js";import"./Box.js";import"./Typography.js";import"./MenuItem.js";import"./ButtonBase.js";import"./useIsFocusVisible.js";import"./listItemIconClasses.js";import"./Divider.js";import"./listItemTextClasses.js";import"./regex.js";import"./Search.js";import"./jsx-runtime_commonjs-proxy.js";import"./Clear.js";import"./IconButton.js";import"./RadioGroup.js";import"./SwitchBase.js";import"./FormGroup.js";import"./FormControlLabel.js";import"./Checkbox.js";import"./SkipNextOutlined.js";import"./Pagination.js";import"./TableRow.js";import"./Loader.js";import"./BootstrapTooltip.js";import"./Tooltip.js";import"./Popper.js";import"./SpeedDial.module.js";import"./Modal.js";import"./Close2.js";import"./DialogTitle.js";import"./dialogTitleClasses.js";import"./ModalTransition.js";import"./Warning.js";import"./Error.js";import"./CheckCircle.js";import"./DialogContent.js";import"./DialogActions.js";import"./LoadingButton.js";import"./SelectedCard.js";import"./Stack.js";import"./LinearProgress.js";const ve=()=>{var T,y,_,C,F;const{register:m,control:r,formState:{errors:t},watch:b}=O(),{fields:a,append:H,remove:f,insert:v}=Q({control:r,name:"rubros"}),l=b("total_ingresos"),n=b("rubros"),o=b("total_licor"),g=X(o);return Y.exports.useEffect(()=>{o>0&&a&&(a.length>0&&a[0].porcentaje!==100||a.length===0)?v(0,{actividad:void 0,porcentaje:100},{shouldFocus:!1}):o<=0&&g&&g>0&&a&&a[0].porcentaje===100&&f(0)},[v,o,a,g,f]),j(Z,{children:[j(s,{container:!0,spacing:1,sx:{mb:1},children:[i(s,{item:!0,xs:12,sm:6,children:i(h,u({label:"D\xEDgito verificador",fullWidth:!0,error:!!(t!=null&&t.dv),helperText:(T=t==null?void 0:t.dv)==null?void 0:T.message},m("dv")))}),i(s,{item:!0,xs:12,sm:6,children:i(h,u({label:"No. contribuyente",fullWidth:!0,error:!!(t!=null&&t.no_contribuyente),helperText:(y=t==null?void 0:t.no_contribuyente)==null?void 0:y.message},m("no_contribuyente")))}),i(s,{item:!0,xs:12,sm:6,md:3,children:i(V,{control:r,label:"Municipio",options:["Panam\xE1","San Miguelito","Chorrera"],error:!!(t!=null&&t.municipio),helperText:(_=t==null?void 0:t.municipio)==null?void 0:_.message,name:"municipio"})}),i(s,{item:!0,xs:12,sm:6,md:3,children:i(M,{label:"Total de ingresos sin licor",name:"total_ingresos",fullWidth:!0,error:!!(t!=null&&t.total_ingresos),helperText:(C=t==null?void 0:t.total_ingresos)==null?void 0:C.message})}),i(s,{item:!0,xs:12,sm:6,md:3,children:i(M,{label:"Total de ingresos por licor",name:"total_licor",fullWidth:!0,error:!!(t!=null&&t.total_licor),helperText:(F=t==null?void 0:t.total_licor)==null?void 0:F.message})}),i(s,{item:!0,xs:12,sm:6,md:3,children:i(h,{label:"Total de ingresos",fullWidth:!0,value:l+o,disabled:!0,InputProps:{inputComponent:U}})})]}),i(L,{title:"Ingresos seg\xFAn actividades",tableHeader:["Rubro","Actividad","Porcentaje","Total"],size:"small",tableBody:a==null?void 0:a.map((p,e)=>{var c,d,A,k,D,W,$,I,P,B,E;return[`Rubro
          ${e===0&&o>0&&p.porcentaje===100?"perteneciente a ingresos por licor":e+1}`,i(h,x(u({label:"Actividad",fullWidth:!0,error:!!((d=(c=t==null?void 0:t.rubros)==null?void 0:c[e])!=null&&d.actividad),helperText:(D=(k=(A=t==null?void 0:t.rubros)==null?void 0:A[e])==null?void 0:k.actividad)==null?void 0:D.message},m(`rubros.${e}.actividad`)),{size:"small"}),`${p.id}-actividad`),i(h,x(u({label:"Porcentaje",fullWidth:!0,error:!!(($=(W=t==null?void 0:t.rubros)==null?void 0:W[e])!=null&&$.porcentaje),helperText:(B=(P=(I=t==null?void 0:t.rubros)==null?void 0:I[e])==null?void 0:P.porcentaje)==null?void 0:B.message},m(`rubros.${e}.porcentaje`)),{disabled:e===0&&o>0&&p.porcentaje===100,InputProps:{endAdornment:i(tt,{position:"end",children:"%"})},InputLabelProps:e===0&&o>0&&p.porcentaje===100?{shrink:!0}:void 0,size:"small"}),`${p.id}-porcentaje`),w((e===0&&(o!=null?o:0)>0&&n[e].porcentaje===100?o!=null?o:0:l!=null?l:0)*(((E=n[e].porcentaje)!=null?E:0)/100))]}).concat([["","Totales",n&&n.length>0?`${n.map(p=>{var e;return Number((e=p.porcentaje)!=null?e:0)}).reduce((p,e)=>p+e)}%`:"0%",i("span",{style:{display:"inline-block",borderTop:"1px solid black",borderBottom:"double black"},children:w(`${n&&n.length>0?n==null?void 0:n.map((p,e)=>{var c,d;return(e===0&&(o!=null?o:0)>0&&((c=p.porcentaje)!=null?c:0)===100?o!=null?o:0:l!=null?l:0)*(((d=p.porcentaje)!=null?d:0)/100)}).reduce((p,e)=>p+e):0}`)},"totales")]])}),j("div",{style:{textAlign:"center",display:"flex",flexDirection:"row",alignItems:"center",justifyContent:"center",marginTop:10},children:[i(G,{variant:"outlined",onClick:()=>H({actividad:void 0,porcentaje:void 0},{shouldFocus:!1}),children:"Agregar rubro"}),a.length>1&&i(G,{variant:"outlined",color:"error",onClick:()=>f(a.length-1),style:{marginLeft:10},children:"Eliminar rubro"})]})]})};export{ve as default};
