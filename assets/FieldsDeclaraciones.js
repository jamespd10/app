var q=Object.defineProperty,J=Object.defineProperties;var K=Object.getOwnPropertyDescriptors;var z=Object.getOwnPropertySymbols;var O=Object.prototype.hasOwnProperty,Q=Object.prototype.propertyIsEnumerable;var M=(e,n,a)=>n in e?q(e,n,{enumerable:!0,configurable:!0,writable:!0,value:a}):e[n]=a,h=(e,n)=>{for(var a in n||(n={}))O.call(n,a)&&M(e,a,n[a]);if(z)for(var a of z(n))Q.call(n,a)&&M(e,a,n[a]);return e},j=(e,n)=>J(e,K(n));import{u as U,c as V}from"./yup.module.js";import{D as w}from"./DecimalInput.js";import{T as b}from"./TextInput.js";import{C as X}from"./CustomDecimal.js";import{S as Y}from"./SelectHookForm.js";import{f as G}from"./string.helper.js";import{_ as Z}from"./usePrevious.js";import{r as L,j as g,F as H,a as r}from"./index.js";import{C as tt}from"./CustomTable.js";import{G as c}from"./Grid.js";import{I as et}from"./InputAdornment.js";import{B as N}from"./Button.js";import"./CircularProgress.js";import"./emotion-react.browser.esm.js";import"./TextField.js";import"./useFormControl.js";import"./useControlled.js";import"./formControlState.js";import"./react-is.production.min.js";import"./Modal2.js";import"./Backdrop.js";import"./Fade.js";import"./isHostComponent.js";import"./Portal.js";import"./Paper.js";import"./Grow.js";import"./List.js";import"./createSvgIcon.js";import"./outlinedInputClasses.js";import"./GlobalStyles.js";import"./react-number-format.es.js";import"./Box.js";import"./Typography.js";import"./MenuItem.js";import"./ButtonBase.js";import"./useIsFocusVisible.js";import"./listItemIconClasses.js";import"./Divider.js";import"./listItemTextClasses.js";import"./regex.js";import"./Search.js";import"./jsx-runtime_commonjs-proxy.js";import"./Clear.js";import"./IconButton.js";import"./FormGroup.js";import"./FormControlLabel.js";import"./Checkbox.js";import"./SkipNextOutlined.js";import"./Pagination.js";import"./TableRow.js";import"./Loader.js";import"./BootstrapTooltip.js";import"./Tooltip.js";import"./Popper.js";import"./SpeedDial.module.js";import"./Modal.js";import"./Close2.js";import"./ModalTransition.js";import"./CheckCircle.js";import"./DialogContent.js";import"./DialogActions.js";import"./LoadingButton.js";import"./SelectedCard.js";import"./Stack.js";import"./LinearProgress.js";const he=e=>{var y,_,C,F,A;const{register:n,control:a,formState:{errors:t},watch:f}=U(),{fields:l,append:R,remove:x,insert:T}=V({control:a,name:"rubros"}),d=f("total_ingresos"),p=f("rubros"),o=f("total_licor"),v=Z(o);return L.exports.useEffect(()=>{o>0&&l&&(l.length>0&&l[0].porcentaje!==100||l.length===0)?T(0,{actividad:void 0,porcentaje:100},{shouldFocus:!1}):o<=0&&v&&v>0&&l&&l[0].porcentaje===100&&x(0)},[T,o,l,v,x]),g(H,{children:[g(c,{container:!0,spacing:1,sx:{mb:1},children:[(!e.dv||!e.no_contribuyente)&&g(H,{children:[(!e.dv||e.dv.toString()==="0"||e.dv.toString().length===0)&&r(c,{item:!0,xs:12,sm:e.dv&&e.dv.toString().length===2&&!e.no_contribuyente?12:6,children:r(b,h({label:"D\xEDgito verificador",fullWidth:!0,error:!!(t!=null&&t.dv),helperText:(y=t==null?void 0:t.dv)==null?void 0:y.message},n("dv")))}),!e.no_contribuyente&&r(c,{item:!0,xs:12,sm:e.dv&&e.dv.toString().length===2&&!e.no_contribuyente?12:6,children:r(b,h({label:"No. contribuyente",fullWidth:!0,error:!!(t!=null&&t.no_contribuyente),helperText:(_=t==null?void 0:t.no_contribuyente)==null?void 0:_.message},n("no_contribuyente")))})]}),r(c,{item:!0,xs:12,sm:6,md:3,children:r(Y,{control:a,label:"Municipio",options:["Panam\xE1","San Miguelito","Chorrera"],error:!!(t!=null&&t.municipio),helperText:(C=t==null?void 0:t.municipio)==null?void 0:C.message,name:"municipio"})}),r(c,{item:!0,xs:12,sm:6,md:3,children:r(w,{label:"Total de ingresos sin licor",name:"total_ingresos",fullWidth:!0,error:!!(t!=null&&t.total_ingresos),helperText:(F=t==null?void 0:t.total_ingresos)==null?void 0:F.message})}),r(c,{item:!0,xs:12,sm:6,md:3,children:r(w,{label:"Total de ingresos por licor",name:"total_licor",fullWidth:!0,error:!!(t!=null&&t.total_licor),helperText:(A=t==null?void 0:t.total_licor)==null?void 0:A.message})}),r(c,{item:!0,xs:12,sm:6,md:3,children:r(b,{label:"Total de ingresos",fullWidth:!0,value:d+o,disabled:!0,InputProps:{inputComponent:X}})})]}),r(tt,{title:"Ingresos seg\xFAn actividades",tableHeader:["Rubro","Actividad","Porcentaje","Total"],size:"small",tableBody:l==null?void 0:l.map((m,i)=>{var s,u,S,k,D,W,$,I,P,B,E;return[`Rubro
          ${i===0&&o>0&&m.porcentaje===100?"perteneciente a ingresos por licor":i+1}`,r(b,j(h({label:"Actividad",fullWidth:!0,error:!!((u=(s=t==null?void 0:t.rubros)==null?void 0:s[i])!=null&&u.actividad),helperText:(D=(k=(S=t==null?void 0:t.rubros)==null?void 0:S[i])==null?void 0:k.actividad)==null?void 0:D.message},n(`rubros.${i}.actividad`)),{size:"small"}),`${m.id}-actividad`),r(b,j(h({label:"Porcentaje",fullWidth:!0,error:!!(($=(W=t==null?void 0:t.rubros)==null?void 0:W[i])!=null&&$.porcentaje),helperText:(B=(P=(I=t==null?void 0:t.rubros)==null?void 0:I[i])==null?void 0:P.porcentaje)==null?void 0:B.message},n(`rubros.${i}.porcentaje`)),{disabled:i===0&&o>0&&m.porcentaje===100,InputProps:{endAdornment:r(et,{position:"end",children:"%"})},InputLabelProps:i===0&&o>0&&m.porcentaje===100?{shrink:!0}:void 0,size:"small"}),`${m.id}-porcentaje`),G((i===0&&(o!=null?o:0)>0&&p[i].porcentaje===100?o!=null?o:0:d!=null?d:0)*(((E=p[i].porcentaje)!=null?E:0)/100))]}).concat([["","Totales",p&&p.length>0?`${p.map(m=>{var i;return Number((i=m.porcentaje)!=null?i:0)}).reduce((m,i)=>m+i)}%`:"0%",r("span",{style:{display:"inline-block",borderTop:"1px solid black",borderBottom:"double black"},children:G(`${p&&p.length>0?p==null?void 0:p.map((m,i)=>{var s,u;return(i===0&&(o!=null?o:0)>0&&((s=m.porcentaje)!=null?s:0)===100?o!=null?o:0:d!=null?d:0)*(((u=m.porcentaje)!=null?u:0)/100)}).reduce((m,i)=>m+i):0}`)},"total")]])}),g("div",{style:{textAlign:"center",display:"flex",flexDirection:"row",alignItems:"center",justifyContent:"center",marginTop:10},children:[r(N,{variant:"outlined",onClick:()=>R({actividad:void 0,porcentaje:void 0},{shouldFocus:!1}),children:"Agregar rubro"}),l.length>1&&r(N,{variant:"outlined",color:"error",onClick:()=>x(l.length-1),style:{marginLeft:10},children:"Eliminar rubro"})]})]})};export{he as default};
