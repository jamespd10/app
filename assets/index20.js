var M=Object.defineProperty,V=Object.defineProperties;var Q=Object.getOwnPropertyDescriptors;var R=Object.getOwnPropertySymbols;var z=Object.prototype.hasOwnProperty,U=Object.prototype.propertyIsEnumerable;var y=(e,r,a)=>r in e?M(e,r,{enumerable:!0,configurable:!0,writable:!0,value:a}):e[r]=a,m=(e,r)=>{for(var a in r||(r={}))z.call(r,a)&&y(e,a,r[a]);if(R)for(var a of R(r))U.call(r,a)&&y(e,a,r[a]);return e},C=(e,r)=>V(e,Q(r));var k=(e,r)=>{var a={};for(var i in e)z.call(e,i)&&r.indexOf(i)<0&&(a[i]=e[i]);if(e!=null&&R)for(var i of R(e))r.indexOf(i)<0&&U.call(e,i)&&(a[i]=e[i]);return a};import{u as W,C as X,c as J,a as d,b as K,g as O,F as Y}from"./array.js";import{B as Z}from"./BackgroundLoader.js";import ee from"./StepperForm.js";import{H as re}from"./HeaderTitle.js";import{u as te}from"./useStepper.js";import{r as S,a as t,O as ie,F as D,j as q,a3 as ae,ag as G}from"./index.js";import{V as oe,S as ne}from"./index.esm.js";import{u as se}from"./useMediaQuery.js";import{L as le,A as de,c as me}from"./Autocomplete.js";import{T as L}from"./Typography.js";import{T as b}from"./TextInput.js";import{P as ce}from"./PhoneInput.js";import{u as ue,g as pe,S as A}from"./useSelectProvincias.js";import{S as I}from"./SelectHookForm.js";import{k as w,a as $,n as he}from"./constantsLists.js";import{F as _}from"./FadeDisappearGrid.js";import{T as P}from"./TimeInput.js";import{G as c}from"./Grid.js";import{t as fe}from"./string.helper.js";import{n as B,u as ge,f as xe,g as be}from"./regex.js";import{M as Fe}from"./Modal2.js";import{C as ve}from"./Card.js";import"./upperFirst.js";import"./Backdrop.js";import"./BootstrapTooltip.js";import"./Tooltip.js";import"./Portal.js";import"./useControlled.js";import"./useIsFocusVisible.js";import"./isHostComponent.js";import"./Grow.js";import"./jwt-decode.esm.js";import"./ContentProvider.js";import"./useModal.js";import"./platform.js";import"./ButtonBase.js";import"./Box.js";import"./extendSxProp.js";import"./createSvgIcon.js";import"./Button.js";import"./Close2.js";import"./jsx-runtime_commonjs-proxy.js";import"./IconButton.js";import"./Error.js";import"./Modal.js";import"./Paper.js";import"./Divider.js";import"./useFetch.js";import"./useHttpService.js";import"./constants.js";import"./TextField.js";import"./FormHelperText.js";import"./react-is.production.min.js";import"./Menu.js";import"./List.js";import"./GlobalStyles.js";import"./Close.js";import"./Chip.js";import"./react-number-format.es.js";import"./MenuItem.js";import"./listItemIconClasses.js";import"./listItemTextClasses.js";import"./nacionalidades.js";import"./usePickerState.js";import"./MonthPicker.js";import"./InputAdornment.js";import"./index7.js";const j=8,Ce=e=>{const{data:r,index:a,style:i}=e,o=r[a],n=C(m({},i),{top:i.top+j});return o.hasOwnProperty("group")?t(le,{component:"div",style:n,children:o.group},o.key):t(D,{children:q("li",C(m({},o[0]),{style:n,children:[o.length<3&&t(L,{noWrap:!0,children:o[1]}),o.length>2&&q("div",{style:{width:"100%",display:"flex",flexDirection:"column",whiteSpace:"nowrap"},children:[t(L,{noWrap:!0,children:o[1]}),t(L,{noWrap:!0,variant:"caption",children:o[2]})]})]}))})},H=S.exports.createContext({}),Se=S.exports.forwardRef((e,r)=>{const a=S.exports.useContext(H);return t("div",m(m({ref:r},e),a))}),qe=e=>{const r=S.exports.useRef(null);return S.exports.useEffect(()=>{r.current!=null&&r.current.resetAfterIndex(0,!0)},[e]),r},Te=S.exports.forwardRef(function(r,a){const v=r,{children:i}=v,o=k(v,["children"]),n=[];i.forEach(u=>{n.push(u),n.push(...u.children||[])});const p=ie(),h=se(p.breakpoints.up("sm"),{noSsr:!0}),f=n.length,x=i[0].length>2?50:h?36:48,g=u=>u.hasOwnProperty("group")?48:x,F=()=>f>8?8*x:n.map(g).reduce((u,s)=>u+s,0),T=qe(f);return t("div",{ref:a,children:t(H.Provider,{value:o,children:t(oe,{itemData:n,height:F()+2*j,width:"100%",ref:T,outerElementType:Se,innerElementType:"ul",itemSize:u=>g(n[u]),overscanCount:5,itemCount:f,children:Ce})})})}),Ee=n=>{var p=n,{options:e,loading:r,property:a,secondProperty:i}=p,o=k(p,["options","loading","property","secondProperty"]);const[h,f]=S.exports.useState(!1),x=()=>f(!1),g=()=>f(!0),{formState:F,setValue:T,control:v}=W();return t(X,{name:o.name,control:v,render:({field:u})=>t(de,C(m({},u),{fullWidth:!0,disablePortal:!0,multiple:o.multiple,open:h,onOpen:()=>{g(),o.onOpen&&o.onOpen()},onClose:()=>{x(),o.onClose&&o.onClose()},getOptionLabel:s=>{let l=a?s[`${a}`].toUpperCase():s.toUpperCase();return i&&s[`${i}`]&&(l+=" - "+s[`${i}`].toUpperCase()),l},options:e,loading:r,disableClearable:o.enableClearable!==!0,onChange:(s,l)=>T(o.name,l,{shouldValidate:!0}),blurOnSelect:o.blurOnSelect,PopperComponent:ne,ListboxComponent:Te,renderOption:(s,l)=>{const E=[s,a?l[`${a}`].toUpperCase():l.toUpperCase()];return i&&l[`${i}`]?E.push(l[`${i}`].toUpperCase()):i&&!l[`${i}`]&&E.push(l[`${i}`]),E},filterOptions:me({matchFrom:"any",ignoreAccents:!0,stringify:s=>{let l=a?s[`${a}`]:s;return i&&s[`${i}`]&&(l+=" "+s[`${i}`]),l}}),renderInput:s=>{var l,E;return t(b,C(m({},s),{variant:"outlined",fullWidth:!0,label:o.label,error:!!((l=F.errors[o.name])!=null&&l.message),helperText:(E=F.errors[o.name])==null?void 0:E.message,required:o.required,InputProps:C(m({},s.InputProps),{endAdornment:q(D,{children:[r?t(ae,{color:"inherit",size:20}):null,s.InputProps.endAdornment]})})}))}}))})},we=()=>{var o,n,p,h;const{formState:{errors:e},watch:r,control:a}=W(),i=r("tipo");return q(D,{children:[t(_,{show:!!(i&&i!==5),item:!0,sm:6,md:4,children:t(I,{control:a,label:"D\xEDa de inicio de labores",options:w,error:!!e.dia_desde,helperText:(o=e.dia_desde)==null?void 0:o.message,name:"dia_desde",required:!0})}),t(_,{show:!!(i&&i!==5),item:!0,sm:6,md:4,children:t(I,{control:a,label:"D\xEDa de finalizaci\xF3n de labores",options:w,error:!!e.dia_hasta,helperText:(n=e.dia_hasta)==null?void 0:n.message,name:"dia_hasta",required:!0})}),t(_,{show:!!(i&&i!==5),item:!0,sm:6,md:4,children:t(P,{label:"Hora de inicio de labores",name:"hora_desde",error:!!e.hora_desde,helperText:(p=e.hora_desde)==null?void 0:p.message,required:!0})}),t(_,{show:!!(i&&i!==5),item:!0,sm:6,md:4,children:t(P,{label:"Hora de finalizaci\xF3n de labores",name:"hora_hasta",error:!!e.hora_hasta,helperText:(h=e.hora_hasta)==null?void 0:h.message,required:!0})})]})},De=()=>{var o,n,p,h,f,x,g,F,T,v,u,s,l;const{register:e,formState:{errors:r},control:a}=W(),i=ue();return t(D,{children:q(c,{container:!0,spacing:1,direction:"row",wrap:"wrap",sx:{"& > :not(style)":{flexGrow:1}},children:[t(c,{item:!0,sm:6,md:4,children:t(b,m({label:"Nombre",fullWidth:!0,error:!!r.nombre,helperText:(o=r.nombre)==null?void 0:o.message,required:!0},e("nombre")))}),t(c,{item:!0,sm:6,md:4,children:t(b,m({label:"Apellido",fullWidth:!0,error:!!r.apellido,helperText:(n=r.apellido)==null?void 0:n.message,required:!0},e("apellido")))}),t(c,{item:!0,sm:6,md:4,children:t(b,m({label:"Usuario",fullWidth:!0,error:!!r.usuario,helperText:(p=r.usuario)==null?void 0:p.message,required:!0},e("usuario")))}),t(c,{item:!0,sm:6,md:4,children:t(b,m({label:"Contrase\xF1a",type:"password",fullWidth:!0,error:!!r.contra,helperText:(h=r.contra)==null?void 0:h.message,required:!0},e("contra")))}),t(c,{item:!0,sm:6,md:4,children:t(I,{control:a,label:"Tipo de usuario",options:["Super","Administrador","Secretari@","Mensajero","Cliente"],values:[1,2,3,4,5],error:!!r.tipo,helperText:(f=r.tipo)==null?void 0:f.message,name:"tipo",required:!0})}),t(c,{item:!0,sm:6,md:4,children:t(I,{control:a,label:"Tipo de identificaci\xF3n",options:$,error:!!r.tipoIdentificacion,helperText:(x=r.tipoIdentificacion)==null?void 0:x.message,name:"tipoIdentificacion",required:!0})}),t(c,{item:!0,sm:6,md:4,children:t(b,m({label:"Identificaci\xF3n",fullWidth:!0,error:!!r.identificacion,helperText:(F=(g=r.identificacion)==null?void 0:g.message)!=null?F:"C\xE9dula o Pasaporte",required:!0},e("identificacion")))}),t(we,{}),t(c,{item:!0,sm:6,md:4,children:t(Ee,{name:"nacionalidad",label:"Nacionalidad",loading:!1,options:pe(),blurOnSelect:!0,required:!0})}),t(c,{item:!0,sm:6,md:4,children:t(b,m({label:"Correo",fullWidth:!0,error:!!r.correo,helperText:(T=r.correo)==null?void 0:T.message},e("correo")))}),t(c,{item:!0,sm:6,md:4,children:t(ce,{name:"telefono",label:"Tel\xE9fono",fullWidth:!0,error:!!r.telefono,helperText:r.telefono&&r.telefono.message?r.telefono.message:"Ejm: 6666-6666 \xF3 222-2222"})}),t(c,{item:!0,sm:6,md:4,children:t(A,{label:"Provincia",value:i.provincia,options:i.listProvincias,error:!!r.provincia,helperText:(v=r.provincia)==null?void 0:v.message,register:e("provincia"),onChange:i.handleChangeProvincia,required:!0})}),t(c,{item:!0,sm:6,md:4,children:t(A,{label:"Distrito",value:i.distrito,options:i.listDistritos,error:!!r.distrito,helperText:(u=r.distrito)==null?void 0:u.message,register:e("distrito"),onChange:i.handleChangeDistrito,required:!0})}),t(c,{item:!0,sm:6,md:"auto",children:t(A,{label:"Corregimiento",value:i.corregimiento,options:i.listCorregimientos,error:!!r.corregimiento,helperText:(s=r.corregimiento)==null?void 0:s.message,register:e("corregimiento"),onChange:i.handleChangeCorregimiento,required:!0})}),t(c,{item:!0,sm:6,md:"auto",children:t(b,m({label:"Direcci\xF3n",fullWidth:!0,error:!!r.direccion,helperText:(l=r.direccion)==null?void 0:l.message,required:!0},e("direccion")))})]})})},N=J().shape({nombre:d().trim().required("Favor de ingresar el nombre").matches(B,"Favor ingresar solo letras del abecedario"),apellido:d().trim().required("Favor de ingresar el apellido").matches(B,"Favor ingresar solo letras del abecedario"),usuario:d().trim().required("Favor de ingresar el usuario").matches(ge,"Favor ingresar el usuario"),contra:d().trim().required("Favor de ingresar la contrase\xF1a").min(6,"Favor ingresar al menos 6 caracteres"),tipo:K().typeError("Favor ingresar seleccionar el tipo de usuario").integer("Favor ingresar seleccionar el tipo de usuario").positive("Favor ingresar seleccionar el tipo de usuario").min(1,"Favor ingresar seleccionar el tipo de usuario").required("Favor ingresar seleccionar el tipo de usuario"),tipoIdentificacion:d().trim().nullable(!0).notRequired().test("is-identificacion","Favor de ingresar un tipo de identificaci\xF3n v\xE1lido: "+$.join(", "),e=>!!(!e||e&&$.includes(e))),identificacion:d().trim().nullable(!0).notRequired().when("tipoIdentificacion",{is:"C\xE9dula",then:d().trim().nullable(!0).notRequired().test("check-Tipo","Favor de ingresar el formato de c\xE9dula v\xE1lido",e=>!!(!e||e&&new RegExp(xe,e)))}).when("tipoIdentificacion",{is:"Pasaporte",then:d().trim().nullable(!0).notRequired().test("check-Tipo","Favor de ingresar el formato de pasaporte v\xE1lido",e=>!!(!e||e&&new RegExp(be,e)))}),nacionalidad:d().trim().nullable(!0).notRequired().test("check-nacionalidad","Favor de seleccionar la nacionalidad",e=>!!(!e||e&&he.includes(e.toLowerCase()))),correo:d().email("Favor ingresar una direcci\xF3n de correo v\xE1lida").nullable(!0).notRequired(),telefono:d().trim().nullable(!0).notRequired().test("check-phoneNumber","Favor ingresar un n\xFAmero de tel\xE9fono v\xE1lido",e=>e?fe(e):!0),provincia:d().trim().nullable(!0).notRequired().max(50,"Favor ingresar m\xE1ximo 50 caracteres"),distrito:d().trim().nullable(!0).notRequired().max(50,"Favor ingresar m\xE1ximo 50 caracteres"),corregimiento:d().trim().nullable(!0).notRequired().max(50,"Favor ingresar m\xE1ximo 50 caracteres"),direccion:d().trim().nullable(!0).notRequired().max(255,"Favor ingresar m\xE1ximo 255 caracteres"),dia_desde:d().trim().nullable().when("tipo",{is:e=>e&&e!==5,then:d().trim().required("Favor seleccionar el d\xEDa de inicio de labores").test("check-dia-desde","Favor seleccionar un d\xEDa de la semana",e=>!!(e&&w.includes(e)))}),dia_hasta:d().trim().nullable().when("tipo",{is:e=>e&&e!==5,then:d().trim().required("Favor seleccionar el d\xEDa de finalizaci\xF3n de labores").test("check-dia-hasta","Favor seleccionar un d\xEDa de la semana",function(e){return!!(e&&this.parent.dia_desde&&w.includes(e)&&w.indexOf(this.parent.dia_desde)<w.indexOf(e))})}),hora_desde:O().transform((e,r)=>r===""?null:e).nullable(!0).when("tipo",{is:e=>e&&e!==5,then:O().typeError("Favor seleccionar la hora de inicio de labores").required("Favor seleccionar la hora de inicio de labores").test("check-hora-desde","Favor seleccionar la hora de inicio de labores",e=>{const r=new Date;return r.setDate(r.getDate()-1),!!(e&&G(r,new Date(e)))})}),hora_hasta:O().transform((e,r)=>r===""?null:e).nullable(!0).when("tipo",{is:e=>e&&e!==5,then:O().typeError("Favor seleccionar la hora de finalizaci\xF3n de labores").required("Favor seleccionar la hora de finalizaci\xF3n de labores").test("check-hora-desde","Favor seleccionar la hora de finalizaci\xF3n de labores",function(e){return!!(e&&G(new Date(this.parent.hora_desde),new Date(e)))})})}),Br=()=>{var g;const{activeStep:e,form:r,handleBack:a,handleNextStep:i,isLoading:o,res:n,modalState:p,setHide:h,handleSubmit:f,handleReset:x}=te({schema:N,fields:[{names:Object.keys(N.fields)}],url:"/admin/usuarios/create"});return q(D,{children:[t(re,{message:"Nuevo usuario"}),t(ve,{variant:"outlined",sx:{p:1,mt:2},children:t(Y,C(m({},r),{children:t(ee,{activeStep:e,handleBack:a,sendLabel:"Guardar",sentLabel:"Guardado",sentLabelImage:"Usuario guardado!",steps:["Datos generales"],handleNext:i,disabledLast:!0,errors:Object.keys(r.formState.errors).length,children:[t(De,{},"Datos-generales")]})}))}),t(Z,{open:o}),t(Fe,{state:p,title:"\xA1Atenci\xF3n!",setHide:n&&n.status===201?h:void 0,body:n?n&&n.error?(g=n.error)==null?void 0:g.message:void 0:"\xBFRealmente desea guardar el usuario?",cancelBotton:{actionFunction:h,text:n?"Cerrar":"Cancelar"},type:n&&n.status===201?"SUCCESS":"ERROR",actionButton:n?n&&n.status===201?{actionFunction:x,text:"Si"}:void 0:{actionFunction:f,text:"Guardar"},children:n&&n.data?q(D,{children:[n.data.message,".",t("br",{}),"Favor de guardar estos datos para enviarselos al usuario. ",t("br",{}),"\xBFDesea guardar otro usuario?"]}):void 0})]})};export{Br as default};
