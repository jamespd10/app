var k=Object.defineProperty,y=Object.defineProperties;var g=Object.getOwnPropertyDescriptors;var b=Object.getOwnPropertySymbols;var O=Object.prototype.hasOwnProperty,R=Object.prototype.propertyIsEnumerable;var f=(e,s,t)=>s in e?k(e,s,{enumerable:!0,configurable:!0,writable:!0,value:t}):e[s]=t,h=(e,s)=>{for(var t in s||(s={}))O.call(s,t)&&f(e,t,s[t]);if(b)for(var t of b(s))R.call(s,t)&&f(e,t,s[t]);return e},C=(e,s)=>y(e,g(s));import{r as a,A as v}from"./index.js";import{A as L,O as E,B as w}from"./constants.js";const I=()=>{const{authState:e}=a.exports.useContext(v);return async(t,{method:n,data:x,params:c,signal:o,isBlob:i})=>{const{token:m}=e,p=new URLSearchParams(c).toString(),S=p?w+t+"?"+p:w+t;try{const r=await fetch(S,{method:n,credentials:"include",mode:"cors",body:JSON.stringify(x),headers:new Headers({"Content-Type":"application/json","x-api-key":L,"x-token":m||"","Access-Control-Allow-Origin":E}),signal:o});if(r.ok&&r.status===201)return{data:i?await r.blob():await r.json(),error:null};if(r.status===200)return{data:null,error:{status:r.status,message:"Sin mensaje de error"}};{const d=await r.text(),l=JSON.parse(d);return{data:null,error:{status:r.status,message:l.message}}}}catch{return o!=null&&o.aborted?{data:null,error:{status:-1,message:"Se cancel\xF3 el env\xEDo de la solicitud"}}:{data:null,error:{status:-1,message:"Ocurri\xF3 un error inesperado"}}}}},P=()=>{const e=a.exports.useMemo(()=>new AbortController,[]),s=a.exports.useMemo(()=>e.signal,[e]),[t,n]=a.exports.useState(!1),[x,c]=a.exports.useState(null),[o,i]=a.exports.useState(null),m=a.exports.useCallback(l=>{c(l)},[]),p=I(),S=a.exports.useCallback(()=>e.abort(),[]),r=a.exports.useCallback(()=>{c(null),i(null),n(!1)},[]),d=a.exports.useCallback(async(l,A)=>{n(!0);const u=await p(l,C(h({},A),{signal:s}));return n(!1),u.data?c(u.data):u.error&&i(u.error),u},[]);return[t,d,x,o,m,r,S]};export{I as a,P as u};
