var Er=Object.defineProperty,Rr=Object.defineProperties;var Ur=Object.getOwnPropertyDescriptors;var de=Object.getOwnPropertySymbols;var Xe=Object.prototype.hasOwnProperty,Ze=Object.prototype.propertyIsEnumerable;var Qe=(e,t,r)=>t in e?Er(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,F=(e,t)=>{for(var r in t||(t={}))Xe.call(t,r)&&Qe(e,r,t[r]);if(de)for(var r of de(t))Ze.call(t,r)&&Qe(e,r,t[r]);return e},K=(e,t)=>Rr(e,Ur(t));var ae=(e,t)=>{var r={};for(var s in e)Xe.call(e,s)&&t.indexOf(s)<0&&(r[s]=e[s]);if(e!=null&&de)for(var s of de(e))t.indexOf(s)<0&&Ze.call(e,s)&&(r[s]=e[s]);return r};import{K as A}from"./index.js";var le=e=>e.type==="checkbox",re=e=>e instanceof Date,B=e=>e==null;const or=e=>typeof e=="object";var T=e=>!B(e)&&!Array.isArray(e)&&or(e)&&!re(e),cr=e=>T(e)&&e.target?le(e.target)?e.target.checked:e.target.value:e,Or=e=>e.substring(0,e.search(/\.\d+(\.|$)/))||e,fr=(e,t)=>e.has(Or(t)),oe=e=>Array.isArray(e)?e.filter(Boolean):[],C=e=>e===void 0,f=(e,t,r)=>{if(!t||!T(e))return r;const s=oe(t.split(/[,[\].]+?/)).reduce((n,l)=>B(n)?n:n[l],e);return C(s)||s===e?C(e[t])?r:e[t]:s};const he={BLUR:"blur",FOCUS_OUT:"focusout",CHANGE:"change"},G={onBlur:"onBlur",onChange:"onChange",onSubmit:"onSubmit",onTouched:"onTouched",all:"all"},z={max:"max",min:"min",maxLength:"maxLength",minLength:"minLength",pattern:"pattern",required:"required",validate:"validate"},dr=A.createContext(null),be=()=>A.useContext(dr),Zr=e=>{const s=e,{children:t}=s,r=ae(s,["children"]);return A.createElement(dr.Provider,{value:r},e.children)};var yr=(e,t,r,s=!0)=>{const n={};for(const l in e)Object.defineProperty(n,l,{get:()=>{const c=l;return t[c]!==G.all&&(t[c]=!s||G.all),r&&(r[c]=!0),e[c]}});return n},W=e=>T(e)&&!Object.keys(e).length,hr=(e,t,r)=>{const l=e,{name:s}=l,n=ae(l,["name"]);return W(n)||Object.keys(n).length>=Object.keys(t).length||Object.keys(n).find(c=>t[c]===(!r||G.all))},N=e=>Array.isArray(e)?e:[e],gr=(e,t,r)=>r&&t?e===t:!e||!t||e===t||N(e).some(s=>s&&(s.startsWith(t)||t.startsWith(s)));function Ae(e){const t=A.useRef(e);t.current=e,A.useEffect(()=>{const r=n=>{n&&n.unsubscribe()},s=!e.disabled&&t.current.subject.subscribe({next:t.current.callback});return()=>r(s)},[e.disabled])}function Lr(e){const t=be(),{control:r=t.control,disabled:s,name:n,exact:l}=e||{},[c,y]=A.useState(r._formState),_=A.useRef({isDirty:!1,dirtyFields:!1,touchedFields:!1,isValidating:!1,isValid:!1,errors:!1}),b=A.useRef(n),V=A.useRef(!0);b.current=n;const p=A.useCallback(h=>V.current&&gr(b.current,h.name,l)&&hr(h,_.current)&&y(F(F({},r._formState),h)),[r,l]);return Ae({disabled:s,callback:p,subject:r._subjects.state}),A.useEffect(()=>(V.current=!0,()=>{V.current=!1}),[]),yr(c,r._proxyFormState,_.current,!1)}var Y=e=>typeof e=="string",vr=(e,t,r,s)=>{const n=Array.isArray(e);return Y(e)?(s&&t.watch.add(e),f(r,e)):n?e.map(l=>(s&&t.watch.add(l),f(r,l))):(s&&(t.watchAll=!0),r)},xe=e=>typeof e=="function",qe=e=>{for(const t in e)if(xe(e[t]))return!0;return!1};function Tr(e){const t=be(),{control:r=t.control,name:s,defaultValue:n,disabled:l,exact:c}=e||{},y=A.useRef(s);y.current=s;const _=A.useCallback(p=>{if(gr(y.current,p.name,c)){const h=vr(y.current,r._names,p.values||r._formValues);V(C(y.current)||T(h)&&!qe(h)?F({},h):Array.isArray(h)?[...h]:C(h)?n:h)}},[r,c,n]);Ae({disabled:l,subject:r._subjects.watch,callback:_});const[b,V]=A.useState(C(n)?r._getWatch(s):n);return A.useEffect(()=>{r._removeUnmounted()}),b}function Mr(e){const t=be(),{name:r,control:s=t.control,shouldUnregister:n}=e,l=fr(s._names.array,r),c=Tr({control:s,name:r,defaultValue:f(s._formValues,r,f(s._defaultValues,r,e.defaultValue)),exact:!0}),y=Lr({control:s,name:r}),_=A.useRef(s.register(r,K(F({},e.rules),{value:c})));return A.useEffect(()=>{const b=(V,p)=>{const h=f(s._fields,V);h&&(h._f.mount=p)};return b(r,!0),()=>{const V=s._options.shouldUnregister||n;(l?V&&!s._stateFlags.action:V)?s.unregister(r):b(r,!1)}},[r,s,l,n]),{field:{name:r,value:c,onChange:A.useCallback(b=>{_.current.onChange({target:{value:cr(b),name:r},type:he.CHANGE})},[r]),onBlur:A.useCallback(()=>{_.current.onBlur({target:{value:f(s._formValues,r),name:r},type:he.BLUR})},[r,s]),ref:A.useCallback(b=>{const V=f(s._fields,r);b&&V&&b.focus&&(V._f.ref={focus:()=>b.focus(),setCustomValidity:p=>b.setCustomValidity(p),reportValidity:()=>b.reportValidity()})},[r,s._fields])},formState:y,fieldState:Object.defineProperties({},{invalid:{get:()=>!!f(y.errors,r)},isDirty:{get:()=>!!f(y.dirtyFields,r)},isTouched:{get:()=>!!f(y.touchedFields,r)},error:{get:()=>f(y.errors,r)}})}}const et=e=>e.render(Mr(e));var _r=(e,t,r,s,n)=>t?K(F({},r[e]),{types:K(F({},r[e]&&r[e].types?r[e].types:{}),{[s]:n||!0})}):{},We=e=>/^\w*$/.test(e),mr=e=>oe(e.replace(/["|']|\]/g,"").split(/\.|\[/));function U(e,t,r){let s=-1;const n=We(t)?[t]:mr(t),l=n.length,c=l-1;for(;++s<l;){const y=n[s];let _=r;if(s!==c){const b=e[y];_=T(b)||Array.isArray(b)?b:isNaN(+n[s+1])?{}:[]}e[y]=_,e=e[y]}return e}const ge=(e,t,r)=>{for(const n of r||Object.keys(e)){const l=f(e,n);if(l){const s=l,{_f:c}=s,y=ae(s,["_f"]);if(c&&t(c.name)){if(c.ref.focus&&C(c.ref.focus()))break;if(c.refs){c.refs[0].focus();break}}else T(y)&&ge(y,t)}}};var J=()=>{const e=typeof performance=="undefined"?Date.now():performance.now()*1e3;return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,t=>{const r=(Math.random()*16+e)%16|0;return(t=="x"?r:r&3|8).toString(16)})},Se=(e,t,r={})=>r.shouldFocus||C(r.shouldFocus)?r.focusName||`${e}.${C(r.focusIndex)?t:r.focusIndex}.`:"",Ne=(e,t,r)=>!r&&(t.watchAll||t.watch.has(e)||[...t.watch].some(s=>e.startsWith(s)&&/^\.\w+/.test(e.slice(s.length))));function De(e,t){return[...e,...N(t)]}var Ie=typeof window!="undefined"&&typeof window.HTMLElement!="undefined"&&typeof document!="undefined";function $(e){let t;const r=Array.isArray(e);if(e instanceof Date)t=new Date(e);else if(e instanceof Set)t=new Set(e);else if(!(Ie&&(e instanceof Blob||e instanceof FileList))&&(r||T(e))){t=r?[]:{};for(const s in e)t[s]=xe(e[s])?e[s]:$(e[s])}else return e;return t}var Ce=e=>Array.isArray(e)?e.map(()=>{}):void 0;function Ee(e,t,r){return[...e.slice(0,t),...N(r),...e.slice(t)]}var Re=(e,t,r)=>Array.isArray(e)?(C(e[r])&&(e[r]=void 0),e.splice(r,0,e.splice(t,1)[0]),e):[];function Ue(e,t){return[...N(t),...N(e)]}function Pr(e,t){let r=0;const s=[...e];for(const n of t)s.splice(n-r,1),r++;return oe(s).length?s:[]}var Oe=(e,t)=>C(t)?[]:Pr(e,N(t).sort((r,s)=>r-s)),Le=(e,t,r)=>{e[t]=[e[r],e[r]=e[t]][0]};function Br(e,t){const r=t.slice(0,-1).length;let s=0;for(;s<r;)e=C(e)?s++:e[t[s++]];return e}function P(e,t){const r=We(t)?[t]:mr(t),s=r.length==1?e:Br(e,r),n=r[r.length-1];let l;s&&delete s[n];for(let c=0;c<r.slice(0,-1).length;c++){let y=-1,_;const b=r.slice(0,-(c+1)),V=b.length-1;for(c>0&&(l=e);++y<b.length;){const p=b[y];_=_?_[p]:e[p],V===y&&(T(_)&&W(_)||Array.isArray(_)&&!_.filter(h=>!C(h)).length)&&(l?delete l[p]:delete e[p]),l=_}}return e}var er=(e,t,r)=>(e[t]=r,e);function rt(e){const t=be(),{control:r=t.control,name:s,keyName:n="id",shouldUnregister:l}=e,[c,y]=A.useState(r._getFieldArray(s)),_=A.useRef(r._getFieldArray(s).map(J)),b=A.useRef(c),V=A.useRef(s),p=A.useRef(!1);V.current=s,b.current=c,r._names.array.add(s);const h=A.useCallback(({values:x,name:m})=>{if(m===V.current||!m){const k=f(x,V.current,[]);y(k),_.current=k.map(J)}},[]);Ae({callback:h,subject:r._subjects.array});const D=A.useCallback(x=>{p.current=!0,r._updateFieldArray(s,x)},[r,s]),se=(x,m)=>{const k=N($(x)),E=De(r._getFieldArray(s),k);r._names.focus=Se(s,E.length-1,m),_.current=De(_.current,k.map(J)),D(E),y(E),r._updateFieldArray(s,E,De,{argA:Ce(x)})},Z=(x,m)=>{const k=N($(x)),E=Ue(r._getFieldArray(s),k);r._names.focus=Se(s,0,m),_.current=Ue(_.current,k.map(J)),D(E),y(E),r._updateFieldArray(s,E,Ue,{argA:Ce(x)})},ie=x=>{const m=Oe(r._getFieldArray(s),x);_.current=Oe(_.current,x),D(m),y(m),r._updateFieldArray(s,m,Oe,{argA:x})},M=(x,m,k)=>{const E=N($(m)),S=Ee(r._getFieldArray(s),x,E);r._names.focus=Se(s,x,k),_.current=Ee(_.current,x,E.map(J)),D(S),y(S),r._updateFieldArray(s,S,Ee,{argA:x,argB:Ce(m)})},H=(x,m)=>{const k=r._getFieldArray(s);Le(k,x,m),Le(_.current,x,m),D(k),y(k),r._updateFieldArray(s,k,Le,{argA:x,argB:m},!1)},O=(x,m)=>{const k=r._getFieldArray(s);Re(k,x,m),Re(_.current,x,m),D(k),y(k),r._updateFieldArray(s,k,Re,{argA:x,argB:m},!1)},Q=(x,m)=>{const k=$(m),E=er(r._getFieldArray(s),x,k);_.current=[...E].map((S,w)=>!S||w===x?J():_.current[w]),D(E),y([...E]),r._updateFieldArray(s,E,er,{argA:x,argB:k},!0,!1)},X=x=>{const m=N($(x));_.current=m.map(J),D([...m]),y([...m]),r._updateFieldArray(s,[...m],k=>k,{},!0,!1)};return A.useEffect(()=>{r._stateFlags.action=!1,Ne(s,r._names)&&r._subjects.state.next({}),p.current&&r._executeSchema([s]).then(x=>{const m=f(x.errors,s),k=f(r._formState.errors,s);(k?!m&&k.type:m&&m.type)&&(m?U(r._formState.errors,s,m):P(r._formState.errors,s),r._subjects.state.next({errors:r._formState.errors}))}),r._subjects.watch.next({name:s,values:r._formValues}),r._names.focus&&ge(r._fields,x=>x.startsWith(r._names.focus)),r._names.focus="",r._proxyFormState.isValid&&r._updateValid()},[c,s,r]),A.useEffect(()=>(!f(r._formValues,s)&&r._updateFieldArray(s),()=>{(r._options.shouldUnregister||l)&&r.unregister(s)}),[s,r,n,l]),{swap:A.useCallback(H,[D,s,r]),move:A.useCallback(O,[D,s,r]),prepend:A.useCallback(Z,[D,s,r]),append:A.useCallback(se,[D,s,r]),remove:A.useCallback(ie,[D,s,r]),insert:A.useCallback(M,[D,s,r]),update:A.useCallback(Q,[D,s,r]),replace:A.useCallback(X,[D,s,r]),fields:A.useMemo(()=>c.map((x,m)=>K(F({},x),{[n]:_.current[m]||J()})),[c,n])}}function Te(){let e=[];return{get observers(){return e},next:n=>{for(const l of e)l.next(n)},subscribe:n=>(e.push(n),{unsubscribe:()=>{e=e.filter(l=>l!==n)}}),unsubscribe:()=>{e=[]}}}var ve=e=>B(e)||!or(e);function te(e,t){if(ve(e)||ve(t))return e===t;if(re(e)&&re(t))return e.getTime()===t.getTime();const r=Object.keys(e),s=Object.keys(t);if(r.length!==s.length)return!1;for(const n of r){const l=e[n];if(!s.includes(n))return!1;if(n!=="ref"){const c=t[n];if(re(l)&&re(c)||T(l)&&T(c)||Array.isArray(l)&&Array.isArray(c)?!te(l,c):l!==c)return!1}}return!0}var rr=e=>({isOnSubmit:!e||e===G.onSubmit,isOnBlur:e===G.onBlur,isOnChange:e===G.onChange,isOnAll:e===G.all,isOnTouch:e===G.onTouched}),_e=e=>typeof e=="boolean",$e=e=>e.type==="file",je=e=>e instanceof HTMLElement,Fr=e=>e.type==="select-multiple",He=e=>e.type==="radio",Nr=e=>He(e)||le(e),Me=e=>je(e)&&e.isConnected;function me(e,t={}){const r=Array.isArray(e);if(T(e)||r)for(const s in e)Array.isArray(e[s])||T(e[s])&&!qe(e[s])?(t[s]=Array.isArray(e[s])?[]:{},me(e[s],t[s])):B(e[s])||(t[s]=!0);return t}function br(e,t,r){const s=Array.isArray(e);if(T(e)||s)for(const n in e)Array.isArray(e[n])||T(e[n])&&!qe(e[n])?C(t)||ve(r[n])?r[n]=Array.isArray(e[n])?me(e[n],[]):F({},me(e[n])):br(e[n],B(t)?{}:t[n],r[n]):r[n]=!te(e[n],t[n]);return r}var Pe=(e,t)=>br(e,t,me(t));const tr={value:!1,isValid:!1},sr={value:!0,isValid:!0};var Ar=e=>{if(Array.isArray(e)){if(e.length>1){const t=e.filter(r=>r&&r.checked&&!r.disabled).map(r=>r.value);return{value:t,isValid:!!t.length}}return e[0].checked&&!e[0].disabled?e[0].attributes&&!C(e[0].attributes.value)?C(e[0].value)||e[0].value===""?sr:{value:e[0].value,isValid:!0}:sr:tr}return tr},xr=(e,{valueAsNumber:t,valueAsDate:r,setValueAs:s})=>C(e)?e:t?e===""?NaN:+e:r&&Y(e)?new Date(e):s?s(e):e;const ir={isValid:!1,value:null};var Vr=e=>Array.isArray(e)?e.reduce((t,r)=>r&&r.checked&&!r.disabled?{isValid:!0,value:r.value}:t,ir):ir;function Be(e){const t=e.ref;if(!(e.refs?e.refs.every(r=>r.disabled):t.disabled))return $e(t)?t.files:He(t)?Vr(e.refs).value:Fr(t)?[...t.selectedOptions].map(({value:r})=>r):le(t)?Ar(e.refs).value:xr(C(t.value)?e.ref.value:t.value,e)}var Ir=(e,t,r,s)=>{const n={};for(const l of e){const c=f(t,l);c&&U(n,l,c._f)}return{criteriaMode:r,names:[...e],fields:n,shouldUseNativeValidation:s}},Fe=e=>e instanceof RegExp,ue=e=>C(e)?void 0:Fe(e)?e.source:T(e)?Fe(e.value)?e.value.source:e.value:e,jr=e=>e.mount&&(e.required||e.min||e.max||e.maxLength||e.minLength||e.pattern||e.validate);function nr(e,t,r){const s=f(e,r);if(s||We(r))return{error:s,name:r};const n=r.split(".");for(;n.length;){const l=n.join("."),c=f(t,l),y=f(e,l);if(c&&!Array.isArray(c)&&r!==l)return{name:r};if(y&&y.type)return{name:l,error:y};n.pop()}return{name:r}}var qr=(e,t,r,s,n)=>n.isOnAll?!1:!r&&n.isOnTouch?!(t||e):(r?s.isOnBlur:n.isOnBlur)?!e:(r?s.isOnChange:n.isOnChange)?e:!0,Wr=(e,t)=>!oe(f(e,t)).length&&P(e,t),ye=e=>Y(e)||A.isValidElement(e);function ar(e,t,r="validate"){if(ye(e)||Array.isArray(e)&&e.every(ye)||_e(e)&&!e)return{type:r,message:ye(e)?e:"",ref:t}}var ee=e=>T(e)&&!Fe(e)?e:{value:e,message:""},ur=async(e,t,r,s)=>{const{ref:n,refs:l,required:c,maxLength:y,minLength:_,min:b,max:V,pattern:p,validate:h,name:D,valueAsNumber:se,mount:Z,disabled:ie}=e._f;if(!Z||ie)return{};const M=l?l[0]:n,H=S=>{s&&M.reportValidity&&(M.setCustomValidity(_e(S)?"":S||" "),M.reportValidity())},O={},Q=He(n),X=le(n),x=Q||X,m=(se||$e(n))&&!n.value||t===""||Array.isArray(t)&&!t.length,k=_r.bind(null,D,r,O),E=(S,w,L,I=z.maxLength,j=z.minLength)=>{const ne=S?w:L;O[D]=F({type:S?I:j,message:ne,ref:n},k(S?I:j,ne))};if(c&&(!x&&(m||B(t))||_e(t)&&!t||X&&!Ar(l).isValid||Q&&!Vr(l).isValid)){const{value:S,message:w}=ye(c)?{value:!!c,message:c}:ee(c);if(S&&(O[D]=F({type:z.required,message:w,ref:M},k(z.required,w)),!r))return H(w),O}if(!m&&(!B(b)||!B(V))){let S,w;const L=ee(V),I=ee(b);if(isNaN(t)){const j=n.valueAsDate||new Date(t);Y(L.value)&&(S=j>new Date(L.value)),Y(I.value)&&(w=j<new Date(I.value))}else{const j=n.valueAsNumber||+t;B(L.value)||(S=j>L.value),B(I.value)||(w=j<I.value)}if((S||w)&&(E(!!S,L.message,I.message,z.max,z.min),!r))return H(O[D].message),O}if((y||_)&&!m&&Y(t)){const S=ee(y),w=ee(_),L=!B(S.value)&&t.length>S.value,I=!B(w.value)&&t.length<w.value;if((L||I)&&(E(L,S.message,w.message),!r))return H(O[D].message),O}if(p&&!m&&Y(t)){const{value:S,message:w}=ee(p);if(Fe(S)&&!t.match(S)&&(O[D]=F({type:z.pattern,message:w,ref:n},k(z.pattern,w)),!r))return H(w),O}if(h){if(xe(h)){const S=await h(t),w=ar(S,M);if(w&&(O[D]=F(F({},w),k(z.validate,w.message)),!r))return H(w.message),O}else if(T(h)){let S={};for(const w in h){if(!W(S)&&!r)break;const L=ar(await h[w](t),M,w);L&&(S=F(F({},L),k(w,L.message)),H(L.message),r&&(O[D]=S))}if(!W(S)&&(O[D]=F({ref:M},S),!r))return O}}return H(!0),O};const $r={mode:G.onSubmit,reValidateMode:G.onChange,shouldFocusError:!0};function Hr(e={}){let t=F(F({},$r),e),r={isDirty:!1,isValidating:!1,dirtyFields:{},isSubmitted:!1,submitCount:0,touchedFields:{},isSubmitting:!1,isSubmitSuccessful:!1,isValid:!1,errors:{}},s={},n=$(t.defaultValues)||{},l=t.shouldUnregister?{}:$(n),c={action:!1,mount:!1,watch:!1},y={mount:new Set,unMount:new Set,array:new Set,watch:new Set},_,b=0,V={};const p={isDirty:!1,dirtyFields:!1,touchedFields:!1,isValidating:!1,isValid:!1,errors:!1},h={watch:Te(),array:Te(),state:Te()},D=rr(t.mode),se=rr(t.reValidateMode),Z=t.criteriaMode===G.all,ie=(i,a)=>(...u)=>{clearTimeout(b),b=window.setTimeout(()=>i(...u),a)},M=async i=>{let a=!1;return p.isValid&&(a=t.resolver?W((await m()).errors):await E(s,!0),!i&&a!==r.isValid&&(r.isValid=a,h.state.next({isValid:a}))),a},H=(i,a=[],u,d,v=!0,o=!0)=>{if(d&&u){if(c.action=!0,o&&Array.isArray(f(s,i))){const g=u(f(s,i),d.argA,d.argB);v&&U(s,i,g)}if(p.errors&&o&&Array.isArray(f(r.errors,i))){const g=u(f(r.errors,i),d.argA,d.argB);v&&U(r.errors,i,g),Wr(r.errors,i)}if(p.touchedFields&&o&&Array.isArray(f(r.touchedFields,i))){const g=u(f(r.touchedFields,i),d.argA,d.argB);v&&U(r.touchedFields,i,g)}p.dirtyFields&&(r.dirtyFields=Pe(n,l)),h.state.next({isDirty:w(i,a),dirtyFields:r.dirtyFields,errors:r.errors,isValid:r.isValid})}else U(l,i,a)},O=(i,a)=>(U(r.errors,i,a),h.state.next({errors:r.errors})),Q=(i,a,u,d)=>{const v=f(s,i);if(v){const o=f(l,i,C(u)?f(n,i):u);C(o)||d&&d.defaultChecked||a?U(l,i,a?o:Be(v._f)):j(i,o),c.mount&&M()}},X=(i,a,u,d,v)=>{let o=!1;const g={name:i},R=f(r.touchedFields,i);if(p.isDirty){const q=r.isDirty;r.isDirty=g.isDirty=w(),o=q!==g.isDirty}if(p.dirtyFields&&(!u||d)){const q=f(r.dirtyFields,i);te(f(n,i),a)?P(r.dirtyFields,i):U(r.dirtyFields,i,!0),g.dirtyFields=r.dirtyFields,o=o||q!==f(r.dirtyFields,i)}return u&&!R&&(U(r.touchedFields,i,u),g.touchedFields=r.touchedFields,o=o||p.touchedFields&&R!==u),o&&v&&h.state.next(g),o?g:{}},x=async(i,a,u,d,v)=>{const o=f(r.errors,a),g=p.isValid&&r.isValid!==u;if(e.delayError&&d?(_=_||ie(O,e.delayError),_(a,d)):(clearTimeout(b),d?U(r.errors,a,d):P(r.errors,a)),((d?!te(o,d):o)||!W(v)||g)&&!i){const R=K(F(F({},v),g?{isValid:u}:{}),{errors:r.errors,name:a});r=F(F({},r),R),h.state.next(R)}V[a]--,p.isValidating&&!Object.values(V).some(R=>R)&&(h.state.next({isValidating:!1}),V={})},m=async i=>t.resolver?await t.resolver(F({},l),t.context,Ir(i||y.mount,s,t.criteriaMode,t.shouldUseNativeValidation)):{},k=async i=>{const{errors:a}=await m();if(i)for(const u of i){const d=f(a,u);d?U(r.errors,u,d):P(r.errors,u)}else r.errors=a;return a},E=async(i,a,u={valid:!0})=>{for(const v in i){const o=i[v];if(o){const d=o,{_f:g}=d,R=ae(d,["_f"]);if(g){const q=await ur(o,f(l,g.name),Z,t.shouldUseNativeValidation);if(q[g.name]&&(u.valid=!1,a))break;a||(q[g.name]?U(r.errors,g.name,q[g.name]):P(r.errors,g.name))}R&&await E(R,a,u)}}return u.valid},S=()=>{for(const i of y.unMount){const a=f(s,i);a&&(a._f.refs?a._f.refs.every(u=>!Me(u)):!Me(a._f.ref))&&pe(i)}y.unMount=new Set},w=(i,a)=>(i&&a&&U(l,i,a),!te(Ge(),n)),L=(i,a,u)=>{const d=F({},c.mount?l:C(a)?n:Y(i)?{[i]:a}:a);return vr(i,y,d,u)},I=i=>oe(f(c.mount?l:n,i,e.shouldUnregister?f(n,i,[]):[])),j=(i,a,u={})=>{const d=f(s,i);let v=a;if(d){const o=d._f;o&&(!o.disabled&&U(l,i,xr(a,o)),v=Ie&&je(o.ref)&&B(a)?"":a,Fr(o.ref)?[...o.ref.options].forEach(g=>g.selected=v.includes(g.value)):o.refs?le(o.ref)?o.refs.length>1?o.refs.forEach(g=>!g.disabled&&(g.checked=Array.isArray(v)?!!v.find(R=>R===g.value):v===g.value)):o.refs[0]&&(o.refs[0].checked=!!v):o.refs.forEach(g=>g.checked=g.value===v):$e(o.ref)?o.ref.value="":(o.ref.value=v,o.ref.type||h.watch.next({name:i})))}(u.shouldDirty||u.shouldTouch)&&X(i,v,u.shouldTouch,u.shouldDirty,!0),u.shouldValidate&&Ve(i)},ne=(i,a,u)=>{for(const d in a){const v=a[d],o=`${i}.${d}`,g=f(s,o);(y.array.has(i)||!ve(v)||g&&!g._f)&&!re(v)?ne(o,v,u):j(o,v,u)}},ce=(i,a,u={})=>{const d=f(s,i),v=y.array.has(i),o=$(a);U(l,i,o),v?(h.array.next({name:i,values:l}),(p.isDirty||p.dirtyFields)&&u.shouldDirty&&(r.dirtyFields=Pe(n,l),h.state.next({name:i,dirtyFields:r.dirtyFields,isDirty:w(i,o)}))):d&&!d._f&&!B(o)?ne(i,o,u):j(i,o,u),Ne(i,y)&&h.state.next({}),h.watch.next({name:i})},Ke=async i=>{const a=i.target;let u=a.name;const d=f(s,u);if(d){let v,o;const g=a.type?Be(d._f):cr(i),R=i.type===he.BLUR||i.type===he.FOCUS_OUT,q=!jr(d._f)&&!t.resolver&&!f(r.errors,u)&&!d._f.deps||qr(R,f(r.touchedFields,u),r.isSubmitted,se,D),fe=Ne(u,y,R);U(l,u,g),R?d._f.onBlur&&d._f.onBlur(i):d._f.onChange&&d._f.onChange(i);const ke=X(u,g,R,!1),Dr=!W(ke)||fe;if(!R&&h.watch.next({name:u,type:i.type}),q)return Dr&&h.state.next(F({name:u},fe?{}:ke));if(!R&&fe&&h.state.next({}),V[u]=(V[u],1),h.state.next({isValidating:!0}),t.resolver){const{errors:ze}=await m([u]),Cr=nr(r.errors,s,u),Je=nr(ze,s,Cr.name||u);v=Je.error,u=Je.name,o=W(ze)}else v=(await ur(d,f(l,u),Z,t.shouldUseNativeValidation))[u],o=await M(!0);d._f.deps&&Ve(d._f.deps),x(!1,u,o,v,ke)}},Ve=async(i,a={})=>{let u,d;const v=N(i);if(h.state.next({isValidating:!0}),t.resolver){const o=await k(C(i)?i:v);u=W(o),d=i?!v.some(g=>f(o,g)):u}else i?(d=(await Promise.all(v.map(async o=>{const g=f(s,o);return await E(g&&g._f?{[o]:g}:g)}))).every(Boolean),!(!d&&!r.isValid)&&M()):d=u=await E(s);return h.state.next(K(F(F({},!Y(i)||p.isValid&&u!==r.isValid?{}:{name:i}),t.resolver?{isValid:u}:{}),{errors:r.errors,isValidating:!1})),a.shouldFocus&&!d&&ge(s,o=>f(r.errors,o),i?v:y.mount),d},Ge=i=>{const a=F(F({},n),c.mount?l:{});return C(i)?a:Y(i)?f(a,i):i.map(u=>f(a,u))},Ye=(i,a)=>({invalid:!!f((a||r).errors,i),isDirty:!!f((a||r).dirtyFields,i),isTouched:!!f((a||r).touchedFields,i),error:f((a||r).errors,i)}),wr=i=>{i?N(i).forEach(a=>P(r.errors,a)):r.errors={},h.state.next({errors:r.errors})},kr=(i,a,u)=>{const d=(f(s,i,{_f:{}})._f||{}).ref;U(r.errors,i,K(F({},a),{ref:d})),h.state.next({name:i,errors:r.errors,isValid:!1}),u&&u.shouldFocus&&d&&d.focus&&d.focus()},Sr=(i,a)=>xe(i)?h.watch.subscribe({next:u=>i(L(void 0,a),u)}):L(i,a,!0),pe=(i,a={})=>{for(const u of i?N(i):y.mount)y.mount.delete(u),y.array.delete(u),f(s,u)&&(a.keepValue||(P(s,u),P(l,u)),!a.keepError&&P(r.errors,u),!a.keepDirty&&P(r.dirtyFields,u),!a.keepTouched&&P(r.touchedFields,u),!t.shouldUnregister&&!a.keepDefaultValue&&P(n,u));h.watch.next({}),h.state.next(F(F({},r),a.keepDirty?{isDirty:w()}:{})),!a.keepIsValid&&M()},we=(i,a={})=>{let u=f(s,i);const d=_e(a.disabled);return U(s,i,{_f:F(K(F({},u&&u._f?u._f:{ref:{name:i}}),{name:i,mount:!0}),a)}),y.mount.add(i),u?d&&U(l,i,a.disabled?void 0:f(l,i,Be(u._f))):Q(i,!0,a.value),K(F(F({},d?{disabled:a.disabled}:{}),t.shouldUseNativeValidation?{required:!!a.required,min:ue(a.min),max:ue(a.max),minLength:ue(a.minLength),maxLength:ue(a.maxLength),pattern:ue(a.pattern)}:{}),{name:i,onChange:Ke,onBlur:Ke,ref:v=>{if(v){we(i,a),u=f(s,i);const o=C(v.value)&&v.querySelectorAll&&v.querySelectorAll("input,select,textarea")[0]||v,g=Nr(o),R=u._f.refs||[];if(g?R.find(q=>q===o):o===u._f.ref)return;U(s,i,{_f:F(F({},u._f),g?{refs:[...R.filter(Me),o,...Array.isArray(f(n,i))?[{}]:[]],ref:{type:o.type,name:i}}:{ref:o})}),Q(i,!1,void 0,o)}else u=f(s,i,{}),u._f&&(u._f.mount=!1),(t.shouldUnregister||a.shouldUnregister)&&!(fr(y.array,i)&&c.action)&&y.unMount.add(i)}})};return{control:{register:we,unregister:pe,getFieldState:Ye,_executeSchema:m,_getWatch:L,_getDirty:w,_updateValid:M,_removeUnmounted:S,_updateFieldArray:H,_getFieldArray:I,_subjects:h,_proxyFormState:p,get _fields(){return s},get _formValues(){return l},get _stateFlags(){return c},set _stateFlags(i){c=i},get _defaultValues(){return n},get _names(){return y},set _names(i){y=i},get _formState(){return r},set _formState(i){r=i},get _options(){return t},set _options(i){t=F(F({},t),i)}},trigger:Ve,register:we,handleSubmit:(i,a)=>async u=>{u&&(u.preventDefault&&u.preventDefault(),u.persist&&u.persist());let d=!0,v=$(l);h.state.next({isSubmitting:!0});try{if(t.resolver){const{errors:o,values:g}=await m();r.errors=o,v=g}else await E(s);W(r.errors)?(h.state.next({errors:{},isSubmitting:!0}),await i(v,u)):(a&&await a(F({},r.errors),u),t.shouldFocusError&&ge(s,o=>f(r.errors,o),y.mount))}catch(o){throw d=!1,o}finally{r.isSubmitted=!0,h.state.next({isSubmitted:!0,isSubmitting:!1,isSubmitSuccessful:W(r.errors)&&d,submitCount:r.submitCount+1,errors:r.errors})}},watch:Sr,setValue:ce,getValues:Ge,reset:(i,a={})=>{const u=i||n,d=$(u),v=i&&!W(i)?d:n;if(a.keepDefaultValues||(n=u),!a.keepValues){if(a.keepDirtyValues)for(const o of y.mount)f(r.dirtyFields,o)?U(v,o,f(l,o)):ce(o,f(v,o));else{if(Ie&&C(i))for(const o of y.mount){const g=f(s,o);if(g&&g._f){const R=Array.isArray(g._f.refs)?g._f.refs[0]:g._f.ref;try{je(R)&&R.closest("form").reset();break}catch{}}}s={}}l=e.shouldUnregister?a.keepDefaultValues?$(n):{}:d,h.array.next({values:v}),h.watch.next({values:v})}y={mount:new Set,unMount:new Set,array:new Set,watch:new Set,watchAll:!1,focus:""},c.mount=!p.isValid||!!a.keepIsValid,c.watch=!!e.shouldUnregister,h.state.next({submitCount:a.keepSubmitCount?r.submitCount:0,isDirty:a.keepDirty||a.keepDirtyValues?r.isDirty:!!(a.keepDefaultValues&&!te(i,n)),isSubmitted:a.keepIsSubmitted?r.isSubmitted:!1,dirtyFields:a.keepDirty||a.keepDirtyValues?r.dirtyFields:a.keepDefaultValues&&i?Pe(n,i):{},touchedFields:a.keepTouched?r.touchedFields:{},errors:a.keepErrors?r.errors:{},isSubmitting:!1,isSubmitSuccessful:!1})},resetField:(i,a={})=>{f(s,i)&&(C(a.defaultValue)?ce(i,f(n,i)):(ce(i,a.defaultValue),U(n,i,a.defaultValue)),a.keepTouched||P(r.touchedFields,i),a.keepDirty||(P(r.dirtyFields,i),r.isDirty=a.defaultValue?w(i,f(n,i)):w()),a.keepError||(P(r.errors,i),p.isValid&&M()),h.state.next(F({},r)))},clearErrors:wr,unregister:pe,setError:kr,setFocus:(i,a={})=>{const u=f(s,i)._f,d=u.refs?u.refs[0]:u.ref;a.shouldSelect?d.select():d.focus()},getFieldState:Ye}}function tt(e={}){const t=A.useRef(),[r,s]=A.useState({isDirty:!1,isValidating:!1,dirtyFields:{},isSubmitted:!1,submitCount:0,touchedFields:{},isSubmitting:!1,isSubmitSuccessful:!1,isValid:!1,errors:{}});t.current?t.current.control._options=e:t.current=K(F({},Hr(e)),{formState:r});const n=t.current.control,l=A.useCallback(c=>{hr(c,n._proxyFormState,!0)&&(n._formState=F(F({},n._formState),c),s(F({},n._formState)))},[n]);return Ae({subject:n._subjects.state,callback:l}),A.useEffect(()=>{n._stateFlags.mount||(n._proxyFormState.isValid&&n._updateValid(),n._stateFlags.mount=!0),n._stateFlags.watch&&(n._stateFlags.watch=!1,n._subjects.state.next({})),n._removeUnmounted()}),t.current.formState=yr(r,n._proxyFormState),t.current}var lr=function(e,t,r){if(e&&"reportValidity"in e){var s=f(r,t);e.setCustomValidity(s&&s.message||""),e.reportValidity()}},pr=function(e,t){var r=function(n){var l=t.fields[n];l&&l.ref&&"reportValidity"in l.ref?lr(l.ref,n,e):l.refs&&l.refs.forEach(function(c){return lr(c,n,e)})};for(var s in t.fields)r(s)},Kr=function(e,t){t.shouldUseNativeValidation&&pr(e,t);var r={};for(var s in e){var n=f(t.fields,s);U(r,s,Object.assign(e[s],{ref:n&&n.ref}))}return r},st=function(e,t,r){return t===void 0&&(t={}),r===void 0&&(r={}),function(s,n,l){try{return Promise.resolve(function(c,y){try{var _=(t.context,Promise.resolve(e[r.mode==="sync"?"validateSync":"validate"](s,Object.assign({abortEarly:!1},t,{context:n}))).then(function(b){return l.shouldUseNativeValidation&&pr({},l),{values:r.rawValues?s:b,errors:{}}}))}catch(b){return y(b)}return _&&_.then?_.then(void 0,y):_}(0,function(c){if(!c.inner)throw c;return{values:{},errors:Kr((y=c,_=!l.shouldUseNativeValidation&&l.criteriaMode==="all",(y.inner||[]).reduce(function(b,V){if(b[V.path]||(b[V.path]={message:V.message,type:V.type}),_){var p=b[V.path].types,h=p&&p[V.type];b[V.path]=_r(V.path,_,b,V.type,h?[].concat(h,V.message):V.message)}return b},{})),l)};var y,_}))}catch(c){return Promise.reject(c)}}};export{et as C,Zr as F,tt as a,Tr as b,rt as c,st as o,be as u};
