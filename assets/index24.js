var go=Object.defineProperty,xo=Object.defineProperties;var bo=Object.getOwnPropertyDescriptors;var Je=Object.getOwnPropertySymbols;var No=Object.prototype.hasOwnProperty,fo=Object.prototype.propertyIsEnumerable;var Ke=(t,o,r)=>o in t?go(t,o,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[o]=r,w=(t,o)=>{for(var r in o||(o={}))No.call(o,r)&&Ke(t,r,o[r]);if(Je)for(var r of Je(o))fo.call(o,r)&&Ke(t,r,o[r]);return t},D=(t,o)=>xo(t,bo(o));import{H as _o}from"./HeaderTitle.js";import{u as vo,a as Co,s as p,d as So}from"./headerPlanilla.module.js";import{r as i,ac as ee,a as e,j as l,F as f,S as Fo,A as wo}from"./index.js";import{N as $o}from"./NotFoundResults.js";import{L as eo}from"./Loader.js";import{g as he}from"./dateHelper.js";import{d as yo,f as _,a as Eo}from"./string.helper.js";import{P as Z}from"./Paper.js";import{S as k}from"./Stack.js";import{D as ge}from"./Divider.js";import{T as S}from"./Typography.js";import{d as Ao}from"./FileDownload.js";import{d as To}from"./ScheduleSend.js";import{d as Po}from"./Assignment.js";import{F as Mo,S as Ro,a as ko}from"./FabButtonAction.js";import{a as Do}from"./ContentProvider.js";import{B as Io}from"./Backdrop.js";import{G as zo}from"./Grow.js";import{d as Ho}from"./Edit.js";import{c as oo,i as to,r as no}from"./jsx-runtime_commonjs-proxy.js";import{u as U}from"./useModal.js";import"./jwt-decode.esm.js";import{u as J}from"./useFetcher.js";import{s as qo}from"./FileSaver.min.js";import{b as ne,c as I,g as ue,a as M,d as Qe,f as ae,o as re,h as ao,j as R,F as ce,u as E,C as Bo}from"./array.js";import{d as Oo,n as te,e as Xe,r as Ye}from"./regex.js";import{d as ro}from"./Delete.js";import{D as L}from"./DecimalInput.js";import{I as so}from"./IconButton.js";import{M as W}from"./Modal2.js";import{a as pe}from"./constantsLists.js";import{S as io}from"./SelectHookForm.js";import{T as Y}from"./TextInput.js";import{F as Vo}from"./FormControlLabel.js";import{C as co}from"./Checkbox.js";import{d as jo,a as Lo}from"./CheckBoxOutlineBlank.js";import{A as Wo}from"./AutocompleteServer.js";import{L as Go}from"./ListItem.js";import{A as le}from"./Alert.js";import{B as ie}from"./Button.js";import{d as Uo}from"./AddBusiness.js";import Jo from"./InputAsociarNegocio.js";import{T as Ko}from"./TextEditor.js";import{I as Qo}from"./InputAdornment.js";import"./BootstrapTooltip.js";import{B as Xo}from"./BackgroundLoader.js";import"./platform.js";import"./Grid.js";import"./extendSxProp.js";import"./index13.js";import"./react-is.production.min.js";import"./AssignmentRounded.js";import"./ButtonBase.js";import"./useIsFocusVisible.js";import"./useControlled.js";import"./Tooltip.js";import"./Portal.js";import"./isHostComponent.js";import"./createSvgIcon.js";import"./constants.js";import"./upperFirst.js";import"./CustomDecimal.js";import"./react-number-format.es.js";import"./Close2.js";import"./Error.js";import"./Modal.js";import"./nacionalidades.js";import"./Box.js";import"./TextField.js";import"./Menu.js";import"./List.js";import"./GlobalStyles.js";import"./MenuItem.js";import"./listItemIconClasses.js";import"./listItemTextClasses.js";import"./useFetch.js";import"./useHttpService.js";import"./Autocomplete.js";import"./Close.js";import"./Chip.js";import"./listItemButtonClasses.js";import"./ChipState.js";import"./index7.js";const F=i.exports.createContext({}),Yo=({children:t})=>{const{id:o}=ee(),r=vo(`/admin/planillas/${o}`);return e(F.Provider,{value:r,children:t})},Zo=()=>{const t=i.exports.useContext(F),[,o]=t;return e(Z,{className:Co.paper,variant:"outlined",children:l(k,{divider:e(ge,{}),direction:"column",spacing:1,children:[l(k,{direction:{xs:"column",md:"row"},justifyContent:"space-between",children:[l(S,{variant:"h5",color:"green",fontWeight:"bold",textTransform:"uppercase",children:[o==null?void 0:o.tipo," ",o==null?void 0:o.nombre_negocio]}),l(k,{direction:"row",alignItems:"center",children:[l(S,{variant:"h5",fontWeight:"bold",textTransform:"uppercase",children:["MES:"," "]}),e(S,{variant:"h5",fontWeight:"bold",textTransform:"uppercase",color:"red",marginLeft:1,children:he(o==null?void 0:o.mes,"MMMM yyyy")})]})]}),l(S,{component:k,spacing:1,direction:"row",children:[e("strong",{children:"Raz\xF3n social:"})," ",e("span",{children:o==null?void 0:o.nom_cliente})]}),l(S,{component:k,spacing:1,direction:"row",children:[e("strong",{children:"RUC:"})," ",e("span",{children:o==null?void 0:o.ruc}),e("strong",{children:"DV:"})," ",e("span",{children:o==null?void 0:o.dv})]}),l(S,{component:k,spacing:1,direction:"row",children:[e("strong",{children:"N. Patronal:"})," ",e("span",{children:o==null?void 0:o.n_patronal}),e("strong",{children:"Patronal SIPE:"})," ",e("span",{children:o==null?void 0:o.patronal_sipe})]}),l(S,{component:k,spacing:1,direction:"row",children:[e("strong",{children:"Ruta:"})," ",e("span",{children:o==null?void 0:o.ruta})]}),(o==null?void 0:o.notas)&&(o==null?void 0:o.notas)!==""&&l(k,{direction:"column",children:[e(S,{variant:"subtitle1",fontWeight:"bold",children:"Notas:"}),yo(o==null?void 0:o.notas)]})]})})},xe=()=>{const[,t]=i.exports.useContext(F),o=i.exports.useMemo(()=>t.negocios.flatMap(n=>n.contratos).map(n=>Number(n.indemnizacion)).some(n=>n>0),[]),r=i.exports.useMemo(()=>t.negocios.flatMap(n=>n.contratos).map(n=>Number(n.preaviso)).some(n=>n>0),[]);return{isIndemnizacion:o,isPreaviso:r}},et=()=>{const{isIndemnizacion:t,isPreaviso:o}=xe();return e("thead",{children:l("tr",{children:[e("th",{className:p.header,children:"Nombre"}),e("th",{className:p.header,children:"C\xE9dula"}),e("th",{className:p.header,children:"Salario"}),e("th",{className:p.header,children:"D\xE9cimo"}),e("th",{className:p.header,children:"Vacaciones"}),e("th",{className:p.header,children:"Imp. Renta"}),e("th",{className:p.header,children:"Horas extras"}),e("th",{className:p.header,children:"Comisiones"}),t&&e("th",{className:p.header,children:"Indemnizaci\xF3n"}),o&&e("th",{className:p.header,children:"Preaviso"}),e("th",{className:p.header,children:"Total"})]})})},ot=()=>{const[,t]=i.exports.useContext(F),{isIndemnizacion:o,isPreaviso:r}=xe();return e(f,{children:t.negocios.flatMap(n=>n.contratos).map(n=>l("tr",{className:p.row,children:[l("td",{className:p.column,children:[n.nombre," ",n.apellido]}),e("td",{className:p.column,children:n.identificacion}),e("td",{className:p.column,children:_(n.salario)}),e("td",{className:p.column,children:_(n.decimo)}),e("td",{className:p.column,children:_(n.vacaciones)}),e("td",{className:p.column,children:_(n.impuesto_renta)}),e("td",{className:p.column,children:_(n.horas_extras)}),e("td",{className:p.column,children:_(n.comisiones)}),o&&e("td",{className:p.column,children:_(n.indemnizacion)}),r&&e("td",{className:p.column,children:_(n.preaviso)}),e("td",{className:p.column,children:_(Number(n.salario)+Number(n.decimo)+Number(n.vacaciones)+Number(n.impuesto_renta)+Number(n.horas_extras)+Number(n.comisiones)+Number(n.indemnizacion)+Number(n.preaviso))})]},`${n.id_contrato}`))})},B=({name:t})=>{const[,o]=i.exports.useContext(F),r=i.exports.useMemo(()=>o.negocios.flatMap(n=>n.contratos).map(n=>Number(n[t])).reduce((n,a)=>n+a),[]);return e("td",{className:p.column,children:_(r)})},tt=()=>{const{isIndemnizacion:t,isPreaviso:o}=xe(),[,r]=i.exports.useContext(F),n=i.exports.useMemo(()=>r.negocios.flatMap(a=>a.contratos).map(a=>Number(a.salario)+Number(a.decimo)+Number(a.vacaciones)+Number(a.impuesto_renta)+Number(a.horas_extras)+Number(a.comisiones)+Number(a.indemnizacion)+Number(a.preaviso)).reduce((a,s)=>a+s),[]);return l("tr",{className:p.row,children:[e("td",{className:p.column,children:"Totales"}),e("td",{className:p.column}),e(B,{name:"salario"}),e(B,{name:"decimo"}),e(B,{name:"vacaciones"}),e(B,{name:"impuesto_renta"}),e(B,{name:"horas_extras"}),e(B,{name:"comisiones"}),t&&e(B,{name:"indemnizacion"}),o&&e(B,{name:"preaviso"}),e("td",{className:p.column,children:_(n)})]})},nt=()=>{const[,t]=i.exports.useContext(F),o=i.exports.useMemo(()=>t.negocios.flatMap(r=>r.contratos).map(r=>Number(r.salario)+Number(r.vacaciones)).reduce((r,n)=>r+n),[]);return e(f,{children:_(o)})},at=()=>l(Z,{variant:"outlined",children:[e(S,{variant:"h5",textTransform:"uppercase",p:1,children:"Planilla - SIPE"}),e("div",{className:p.tableResponsive,children:l("table",{className:p.table,children:[e(et,{}),l("tbody",{children:[e(ot,{}),e(tt,{})]})]})}),l(S,{variant:"h5",p:1,children:["Salarios + vacaciones ="," ",e("strong",{children:e(nt,{})})]})]}),be=t=>{const[,o]=i.exports.useContext(F),r=i.exports.useMemo(()=>o.negocios[t].contratos.map(a=>Number(a.indemnizacion)).some(a=>a>0),[]),n=i.exports.useMemo(()=>o.negocios[t].contratos.map(a=>Number(a.preaviso)).some(a=>a>0),[]);return{isIndemnizacion:r,isPreaviso:n}},rt=({index:t})=>{const{isIndemnizacion:o,isPreaviso:r}=be(t);return e("thead",{children:l("tr",{children:[e("th",{className:p.header,children:"Nombre"}),e("th",{className:p.header,children:"C\xE9dula"}),e("th",{className:p.header,children:"Salario"}),e("th",{className:p.header,children:"D\xE9cimo"}),e("th",{className:p.header,children:"Vacaciones"}),e("th",{className:p.header,children:"Imp. Renta"}),e("th",{className:p.header,children:"Horas extras"}),e("th",{className:p.header,children:"Comisiones"}),o&&e("th",{className:p.header,children:"Indemnizaci\xF3n"}),r&&e("th",{className:p.header,children:"Preaviso"}),e("th",{className:p.header,children:"Total"})]})})},st=({index:t})=>{const[,o]=i.exports.useContext(F),{isIndemnizacion:r,isPreaviso:n}=be(t);return e(f,{children:o.negocios[t].contratos.map(a=>l("tr",{className:p.row,children:[l("td",{className:p.column,children:[a.nombre," ",a.apellido]}),e("td",{className:p.column,children:a.identificacion}),e("td",{className:p.column,children:_(a.salario)}),e("td",{className:p.column,children:_(a.decimo)}),e("td",{className:p.column,children:_(a.vacaciones)}),e("td",{className:p.column,children:_(a.impuesto_renta)}),e("td",{className:p.column,children:_(a.horas_extras)}),e("td",{className:p.column,children:_(a.comisiones)}),r&&e("td",{className:p.column,children:_(a.indemnizacion)}),n&&e("td",{className:p.column,children:_(a.preaviso)}),e("td",{className:p.column,children:_(Number(a.salario)+Number(a.decimo)+Number(a.vacaciones)+Number(a.impuesto_renta)+Number(a.horas_extras)+Number(a.comisiones)+Number(a.indemnizacion)+Number(a.preaviso))})]},`${a.id_contrato}`))})},it=({index:t})=>{const[,o]=i.exports.useContext(F),r=i.exports.useMemo(()=>o.negocios[t].contratos.map(n=>Number(n.salario)+Number(n.vacaciones)).reduce((n,a)=>n+a),[]);return e(f,{children:_(r)})},O=({index:t,name:o})=>{const[,r]=i.exports.useContext(F),n=i.exports.useMemo(()=>r.negocios[t].contratos.map(a=>Number(a[o])).reduce((a,s)=>a+s),[]);return e("td",{className:p.column,children:_(n)})},ct=({index:t})=>{const{isIndemnizacion:o,isPreaviso:r}=be(t),[,n]=i.exports.useContext(F),a=i.exports.useMemo(()=>n.negocios[t].contratos.map(s=>Number(s.salario)+Number(s.decimo)+Number(s.vacaciones)+Number(s.impuesto_renta)+Number(s.horas_extras)+Number(s.comisiones)+Number(s.indemnizacion)+Number(s.preaviso)).reduce((s,m)=>s+m),[]);return l("tr",{className:p.row,children:[e("td",{className:p.column,children:"Totales"}),e("td",{className:p.column}),e(O,{index:t,name:"salario"}),e(O,{index:t,name:"decimo"}),e(O,{index:t,name:"vacaciones"}),e(O,{index:t,name:"impuesto_renta"}),e(O,{index:t,name:"horas_extras"}),e(O,{index:t,name:"comisiones"}),o&&e(O,{index:t,name:"indemnizacion"}),r&&e(O,{index:t,name:"preaviso"}),e("td",{className:p.column,children:_(a)})]})},lt=()=>{const[,t]=i.exports.useContext(F);return t.negocios.length===1?e(f,{}):l(f,{children:[e(S,{variant:"h4",textTransform:"uppercase",textAlign:"center",children:"Planilla seccionada por negocios"}),t.negocios.map((o,r)=>l(Z,{variant:"outlined",children:[l(S,{variant:"h5",textTransform:"uppercase",p:1,color:r===0?"red":"orange",children:[o.tipo," ",o.nombre]}),e("div",{className:p.tableResponsive,children:l("table",{className:p.table,children:[e(rt,{index:r}),l("tbody",{children:[e(st,{index:r}),e(ct,{index:r})]})]})}),l(S,{variant:"h5",p:1,children:["Salarios + vacaciones ="," ",e("strong",{children:e(it,{index:r})})]})]},`${o.id_negocio}`))]})},dt=({acciones:t,icon:o,title:r})=>{const[n,a]=i.exports.useState(!1),s=()=>a(!0),m=()=>a(!1),{contentScroll:u}=i.exports.useContext(Do),[,,,c]=u;return i.exports.useEffect(()=>{(()=>{c.current&&(c.current.style.marginBottom="50px")})()},[]),t.length===1?e(Mo,{text:t[0].title,icon:t[0].icon,onClick:()=>t[0].onClick()}):l(f,{children:[e(Io,{open:n,sx:{zIndex:d=>d.zIndex.modal}}),e(zo,{in:!0,timeout:700,children:e(Ro,{ariaLabel:"Custom SpeedDial",FabProps:{variant:"extended",size:"medium"},sx:{position:"fixed",bottom:10,right:10,zIndex:d=>d.zIndex.modal},icon:l(k,{direction:"row",spacing:1,children:[o||e(Po,{}),r||"Acciones"]}),onClose:m,onOpen:s,open:n,children:t.slice().reverse().map((d,x)=>e(ko,{icon:e(Fo,{component:d.icon}),tooltipTitle:d.title,tooltipOpen:!0,onClick:()=>{m(),d.onClick()}},d.title))})})]})};var Ne={},mt=to.exports;Object.defineProperty(Ne,"__esModule",{value:!0});var lo=Ne.default=void 0,ut=mt(oo),pt=no,ht=(0,ut.default)((0,pt.jsx)("path",{d:"m14.5 14.2 2.9 1.7-.8 1.3L13 15v-5h1.5v4.2zM22 14c0 4.41-3.59 8-8 8-2.02 0-3.86-.76-5.27-2H4c-1.15 0-2-.85-2-2V9c0-1.12.89-1.96 2-2v-.5C4 4.01 6.01 2 8.5 2c2.34 0 4.24 1.79 4.46 4.08.34-.05.69-.08 1.04-.08 4.41 0 8 3.59 8 8zM6 7h5v-.74C10.88 4.99 9.8 4 8.5 4 7.12 4 6 5.12 6 6.5V7zm14 7c0-3.31-2.69-6-6-6s-6 2.69-6 6 2.69 6 6 6 6-2.69 6-6z"}),"LockClock");lo=Ne.default=ht;const H=i.exports.createContext({}),gt=({children:t})=>{const[o,r]=i.exports.useState(!1),n=d=>r(d),a=U(),s=U(),m=U(),u=U(),c=J();return e(H.Provider,{value:{editing:o,setEditing:n,modalDownload:a,modalEditar:s,modalGenerarPassword:m,modalSend:u,fetchDownload:c},children:t})},xt=()=>{const{id:t}=ee(),{fetchDownload:o,modalDownload:r}=i.exports.useContext(H),[,n]=o,{setOpen:a}=r,[,s]=i.exports.useContext(F),m=i.exports.useMemo(()=>`PLANILLA-${he(s==null?void 0:s.mes,"MMMM-yyyy")}-${(s==null?void 0:s.tipo)||""} ${(s==null?void 0:s.nombre_negocio)||""}`.replaceAll(" ","-").toUpperCase(),[s]);return()=>{n(`/admin/planillas/${t}/generar`,{isBlob:!0}).then(c=>{c.data&&qo(c.data,`${m}.xlsx`)}).finally(()=>{a()})}},bt=()=>{const[,t]=i.exports.useContext(F),o=i.exports.useContext(H),{modalEditar:r,modalGenerarPassword:n,modalSend:a}=o,{setOpen:s}=r,{authState:m}=i.exports.useContext(wo),{tipo:u}=m,c=xt();return e(f,{children:e(f,{children:e(dt,{acciones:[...u==="Super"?[{title:"Generar contrase\xF1a",icon:lo,onClick:()=>n.setOpen()}]:[],{title:"Generar SIPE",icon:Ao,onClick:()=>c()},...t.fecha_send_sipe?[]:[{title:"Marcar como enviada al SIPE",icon:To,onClick:()=>a.setOpen()}],...Boolean(Number(t.can_edit))?[{title:"Editar",icon:Ho,onClick:()=>s()}]:[]]})})})},V=ne().typeError("Ingresar un valor").positive("La cantidad del salario debe ser positiva").min(0,"La cantidad del salario debe ser mayor a 0").max(9e10,"M\xE1ximo 10 d\xEDgitos").required("Ingresar un valor").test("check-decimal","Favor ingresar m\xE1ximo dos decimales",t=>!!(t===0||t&&t.toString().match(Oo))),Nt=I().shape({mes:ue().typeError("Favor ingresar el mes de la planilla a realizar").required("Favor ingresar el mes de la planilla a realizar"),notas:M().trim().nullable(!0).notRequired(),negocios:Qe().of(I().shape({id_negocio:ne().typeError("Favor ingresar el negocio").positive("Favor ingresar el negocio").integer("Favor ingresar el negocio").required("Favor ingresar el negocio"),contratos:Qe().of(I().shape({salario:V,decimo:V,vacaciones:V,impuesto_renta:V,horas_extras:V,comisiones:V,preaviso:V,indemnizacion:V,id_contrato:ne().typeError("El id es requerido").required("El id es requerido").positive("El id debe ser un n\xFAmero positivo").integer("El id debe ser un n\xFAmero entero")})).min(1,"Favor ingresar al menos un empleado")})).min(1,"Favor ingresar al menos un negocio")}),K=i.exports.createContext({}),ft=({children:t})=>{const o=i.exports.useContext(F),[,r]=o,n=i.exports.useMemo(()=>["4","8","12"].includes(he(r.mes,"M")),[]),a=ae({mode:"all",resolver:re(Nt),defaultValues:{notas:Eo(r.notas),mes:r.mes,negocios:r.negocios.map(c=>D(w({},c),{contratos:c.contratos.map(d=>D(w({},d),{complete_name:`${d.nombre} ${d.apellido}`,identificacion:d.identificacion}))}))}}),s=ao({control:a.control,name:"negocios"}),m=R({control:a.control,name:"negocios"}),u=J();return e(ce,D(w({},a),{children:e(K.Provider,{value:{fieldsNegocios:s,negocios:m,isDecimo:n,mainNegocioId:r.id_negocio,clienteId:r.id_cliente,fetcherSaveData:u},children:t})}))},_t="_paperTables_sw5i7_1",vt="_fechaTables_sw5i7_5",Ct="_paperNotas_sw5i7_11",St="_tableResponsive_sw5i7_15",Ft="_table_sw5i7_15",wt="_lastedTableResponsive_sw5i7_25",$t="_header_sw5i7_30",yt="_column_sw5i7_50",Et="_row_sw5i7_57",At="_columnClick_sw5i7_71",Tt="_columnClickEdit_sw5i7_76",Pt="_icon_sw5i7_106",Mt="_inputDecimal_sw5i7_110";var h={paperTables:_t,fechaTables:vt,paperNotas:Ct,tableResponsive:St,table:Ft,lastedTableResponsive:wt,header:$t,column:yt,row:Et,columnClick:At,columnClickEdit:Tt,icon:Pt,inputDecimal:Mt};const j=({negocioIndex:t,name:o})=>{const{control:r}=E(),n=R({control:r,name:`negocios.${t}.contratos`}),a=i.exports.useMemo(()=>n&&n.length>0?n.map(s=>Number(s[o]||0)).reduce((s,m)=>s+m):0,[n]);return e(f,{children:_(a)})},Rt=({negocioIndex:t})=>{const{control:o}=E(),r=R({control:o,name:`negocios.${t}.contratos`}),n=i.exports.useMemo(()=>r&&r.length>0?r.map(a=>Number(a.salario||0)+Number(a.decimo||0)+Number(a.vacaciones||0)+Number(a.impuesto_renta||0)+Number(a.horas_extras||0)+Number(a.comisiones||0)+Number(a.indemnizacion||0)+Number(a.preaviso||0)).reduce((a,s)=>a+s):0,[r]);return e(f,{children:_(n)})},kt=({negocioIndex:t})=>{const{control:o}=E(),r=R({control:o,name:`negocios.${t}.contratos`});return i.exports.useMemo(()=>r&&r.length>0&&r.map(a=>Number(a.vacaciones||0)).reduce((a,s)=>a+s)>0,[r])?l(f,{children:[e("td",{className:h.column,children:e(j,{name:"indemnizacion",negocioIndex:t})}),e("td",{className:h.column,children:e(j,{name:"preaviso",negocioIndex:t})})]}):e(f,{})},Dt=({negocioIndex:t})=>l("tr",{className:h.row,children:[e("td",{className:h.column,children:"Totales"}),e("td",{className:h.column}),e("td",{className:h.column,children:e(j,{name:"salario",negocioIndex:t})}),e("td",{className:h.column,children:e(j,{name:"decimo",negocioIndex:t})}),e("td",{className:h.column,children:e(j,{name:"vacaciones",negocioIndex:t})}),e("td",{className:h.column,children:e(j,{name:"impuesto_renta",negocioIndex:t})}),e("td",{className:h.column,children:e(j,{name:"horas_extras",negocioIndex:t})}),e("td",{className:h.column,children:e(j,{name:"comisiones",negocioIndex:t})}),e(kt,{negocioIndex:t}),e("td",{colSpan:2,className:h.column,children:e(Rt,{negocioIndex:t})})]}),It=({negocioIndex:t,contratoIndex:o})=>{const{control:r}=E(),n=R({control:r,name:`negocios.${t}.contratos.${o}`}),a=i.exports.useMemo(()=>Number(n.salario||0)+Number(n.decimo||0)+Number(n.vacaciones||0)+Number(n.impuesto_renta||0)+Number(n.horas_extras||0)+Number(n.comisiones||0)+Number(n.indemnizacion||0)+Number(n.preaviso||0),[n]);return e("span",{children:_(a)})},zt=({negocioIndex:t})=>{const{control:o}=E(),r=R({control:o,name:`negocios.${t}.contratos`});return i.exports.useMemo(()=>r&&r.length>0&&r.map(a=>Number(a.vacaciones||0)).reduce((a,s)=>a+s)>0,[r])?l(f,{children:[e("th",{className:h.header,children:"Indemnizaci\xF3n"}),e("th",{className:h.header,children:"Preaviso"})]}):e(f,{})},Ht=({negocioIndex:t})=>e("thead",{children:l("tr",{children:[e("th",{className:h.header,children:"Nombre"}),e("th",{className:h.header,children:"C\xE9dula"}),e("th",{className:h.header,children:"Salario"}),e("th",{className:h.header,children:"D\xE9cimo"}),e("th",{className:h.header,children:"Vacaciones"}),e("th",{className:h.header,children:"Imp. Renta"}),e("th",{className:h.header,children:"Horas extras"}),e("th",{className:h.header,children:"Comisiones"}),e(zt,{negocioIndex:t}),e("th",{className:h.header,children:"Total"}),e("th",{className:h.header,children:"Remover"})]})}),qt=({negocioIndex:t,contratoIndex:o})=>{var u,c,d,x,N,g,b,v,C,A,T,P,z,$,y,q,G,oe;const{control:r,formState:n}=E(),{errors:a}=n,s=R({control:r,name:`negocios.${t}.contratos`});return i.exports.useMemo(()=>s&&s.length>0&&s.map(X=>Number(X.vacaciones||0)).reduce((X,se)=>X+se)>0,[s])?l(f,{children:[e("td",{className:h.column,children:e(L,{className:h.inputDecimal,name:`negocios.${t}.contratos.${o}.indemnizacion`,label:"Indemnizaci\xF3n",fullWidth:!0,error:!!((x=(d=(c=(u=a==null?void 0:a.negocios)==null?void 0:u[Number(t)])==null?void 0:c.contratos)==null?void 0:d[Number(o)])!=null&&x.indemnizacion),helperText:(C=(v=(b=(g=(N=a==null?void 0:a.negocios)==null?void 0:N[Number(t)])==null?void 0:g.contratos)==null?void 0:b[Number(o)])==null?void 0:v.indemnizacion)==null?void 0:C.message,size:"small"})}),e("td",{className:h.column,children:e(L,{className:h.inputDecimal,name:`negocios.${t}.contratos.${o}.preaviso`,label:"Preaviso",fullWidth:!0,error:!!((z=(P=(T=(A=a==null?void 0:a.negocios)==null?void 0:A[Number(t)])==null?void 0:T.contratos)==null?void 0:P[Number(o)])!=null&&z.preaviso),helperText:(oe=(G=(q=(y=($=a==null?void 0:a.negocios)==null?void 0:$[Number(t)])==null?void 0:y.contratos)==null?void 0:q[Number(o)])==null?void 0:G.preaviso)==null?void 0:oe.message,size:"small"})})]}):e(f,{})},Bt=({negocioIndex:t,contratoIndex:o})=>{var u,c,d,x,N,g,b,v,C;const{control:r,setValue:n,formState:a}=E(),{errors:s}=a,m=R({control:r,name:`negocios.${t}.contratos.${o}.salario`});return i.exports.useEffect(()=>{(()=>{m&&m!==""&&Number(m)>=800?n(`negocios.${t}.contratos.${o}.impuesto_renta`,""):n(`negocios.${t}.contratos.${o}.impuesto_renta`,0)})()},[m]),e(L,{className:h.inputDecimal,name:`negocios.${t}.contratos.${o}.impuesto_renta`,label:"Imp. Renta",fullWidth:!0,error:!!((x=(d=(c=(u=s==null?void 0:s.negocios)==null?void 0:u[Number(t)])==null?void 0:c.contratos)==null?void 0:d[Number(o)])!=null&&x.impuesto_renta),helperText:(C=(v=(b=(g=(N=s==null?void 0:s.negocios)==null?void 0:N[Number(t)])==null?void 0:g.contratos)==null?void 0:b[Number(o)])==null?void 0:v.impuesto_renta)==null?void 0:C.message,size:"small"})},Q=i.exports.createContext({}),Ot=({children:t,clienteId:o,mainNegocioId:r,negocioIndex:n,isDecimo:a})=>{const s=U(),{control:m}=E(),{fields:u,remove:c,append:d,update:x}=ao({control:m,name:`negocios.${n}.contratos`});return e(Q.Provider,{value:{modalAgregarContrato:s,clienteId:o,mainNegocioId:r,negocioIndex:n,fields:u,remove:c,append:d,update:x,isDecimo:a},children:t})},de=i.exports.createContext({}),Vt=({children:t})=>{const[o,r]=i.exports.useState(null),n=i.exports.useCallback((s,m)=>{r({negocioIndex:s,contratoIndex:m})},[]),a=i.exports.useCallback(()=>r(null),[]);return e(de.Provider,{value:{negocioContrato:o,setNegocioContrato:n,setNullNegocioContrato:a},children:t})},jt=t=>{const{negocioIndex:o}=t,{formState:r}=E(),{errors:n}=r,{fields:a,remove:s}=i.exports.useContext(Q),{setNegocioContrato:m}=i.exports.useContext(de);return e("div",{className:h.tableResponsive,children:l("table",{className:h.table,children:[e(Ht,{negocioIndex:o}),l("tbody",{children:[a==null?void 0:a.map((u,c)=>{var d,x,N,g,b,v,C,A,T,P,z,$,y,q,G,oe,X,se,ve,Ce,Se,Fe,we,$e,ye,Ee,Ae,Te,Pe,Me,Re,ke,De,Ie,ze,He,qe,Be,Oe,Ve,je,Le,We,Ge,Ue;return l("tr",{className:h.row,children:[l("td",{className:`${h.column} ${h.columnClick}`,onClick:()=>m(Number(o),c),children:[e("div",{className:h.columnClickEdit,children:e("span",{})}),l("span",{children:[u.nombre," ",u.apellido]})]}),e("td",{className:h.column,children:e("span",{children:u.identificacion})}),e("td",{className:h.column,children:e(L,{className:h.inputDecimal,name:`negocios.${o}.contratos.${c}.salario`,label:"Salario",fullWidth:!0,error:!!((g=(N=(x=(d=n==null?void 0:n.negocios)==null?void 0:d[Number(o)])==null?void 0:x.contratos)==null?void 0:N[c])!=null&&g.salario),helperText:(T=(A=(C=(v=(b=n==null?void 0:n.negocios)==null?void 0:b[Number(o)])==null?void 0:v.contratos)==null?void 0:C[c])==null?void 0:A.salario)==null?void 0:T.message,size:"small"})}),e("td",{className:h.column,children:e(L,{className:h.inputDecimal,name:`negocios.${o}.contratos.${c}.decimo`,label:"D\xE9cimo",fullWidth:!0,error:!!((y=($=(z=(P=n==null?void 0:n.negocios)==null?void 0:P[Number(o)])==null?void 0:z.contratos)==null?void 0:$[c])!=null&&y.decimo),helperText:(se=(X=(oe=(G=(q=n==null?void 0:n.negocios)==null?void 0:q[Number(o)])==null?void 0:G.contratos)==null?void 0:oe[c])==null?void 0:X.decimo)==null?void 0:se.message,size:"small"})}),e("td",{className:h.column,children:e(L,{className:h.inputDecimal,name:`negocios.${o}.contratos.${c}.vacaciones`,label:"Vacaciones",fullWidth:!0,error:!!((Fe=(Se=(Ce=(ve=n==null?void 0:n.negocios)==null?void 0:ve[Number(o)])==null?void 0:Ce.contratos)==null?void 0:Se[c])!=null&&Fe.vacaciones),helperText:(Ae=(Ee=(ye=($e=(we=n==null?void 0:n.negocios)==null?void 0:we[Number(o)])==null?void 0:$e.contratos)==null?void 0:ye[c])==null?void 0:Ee.vacaciones)==null?void 0:Ae.message,size:"small"})}),e("td",{className:h.column,children:e(Bt,{negocioIndex:o,contratoIndex:c})}),e("td",{className:h.column,children:e(L,{className:h.inputDecimal,name:`negocios.${o}.contratos.${c}.horas_extras`,label:"Horas extras",fullWidth:!0,error:!!((Re=(Me=(Pe=(Te=n==null?void 0:n.negocios)==null?void 0:Te[Number(o)])==null?void 0:Pe.contratos)==null?void 0:Me[c])!=null&&Re.horas_extras),helperText:(He=(ze=(Ie=(De=(ke=n==null?void 0:n.negocios)==null?void 0:ke[Number(o)])==null?void 0:De.contratos)==null?void 0:Ie[c])==null?void 0:ze.horas_extras)==null?void 0:He.message,size:"small"})}),e("td",{className:h.column,children:e(L,{className:h.inputDecimal,name:`negocios.${o}.contratos.${c}.comisiones`,label:"Comisiones",fullWidth:!0,error:!!((Ve=(Oe=(Be=(qe=n==null?void 0:n.negocios)==null?void 0:qe[Number(o)])==null?void 0:Be.contratos)==null?void 0:Oe[c])!=null&&Ve.comisiones),helperText:(Ue=(Ge=(We=(Le=(je=n==null?void 0:n.negocios)==null?void 0:je[Number(o)])==null?void 0:Le.contratos)==null?void 0:We[c])==null?void 0:Ge.comisiones)==null?void 0:Ue.message,size:"small"})}),e(qt,{negocioIndex:o,contratoIndex:c}),e("td",{className:h.column,children:e(It,{negocioIndex:o,contratoIndex:c})}),e("td",{className:`${h.column} ${h.icon}`,children:e(so,{color:"error",onClick:()=>s(c),children:e(ro,{})})})]},`${u.id}`)}),e(Dt,{negocioIndex:o})]})]})})},Lt=t=>{const{negocioIndex:o}=t,{control:r}=E(),n=R({control:r,name:`negocios.${o}.contratos`}),a=i.exports.useMemo(()=>n&&n.length>0?n.map(s=>Number(s.salario||0)+Number(s.vacaciones||0)).reduce((s,m)=>s+m):0,[n]);return l(S,{variant:"h5",children:["Salarios + Vacaciones = ",e("strong",{children:_(a)})," "]})},Wt=(t,o)=>{const[,r,,,,n]=o,{negocios:a}=i.exports.useContext(K),{append:s,mainNegocioId:m,clienteId:u,modalAgregarContrato:c,isDecimo:d}=i.exports.useContext(Q),{setHide:x}=c;return{handleAppenContrato:async g=>{if(g.seleccion==="old"){const b=a.flatMap(C=>C.contratos);(b==null?void 0:b.find(C=>Number(C.id_contrato)===Number(g.empleado_selected.id)))?t.setError("empleado_selected.id",{type:"manual",message:"El empleado ya existe en la lista actual. Favor seleccionar otro o crear uno nuevo."}):(s({salario:"",decimo:d?"":0,vacaciones:0,preaviso:0,indemnizacion:0,impuesto_renta:0,id_contrato:Number(g.empleado_selected.id),nombre:g.empleado_selected.nombre||"",apellido:g.empleado_selected.apellido||"",complete_name:g.empleado_selected.complete_name||"",identificacion:g.empleado_selected.identificacion||"",horas_extras:0,comisiones:0,tipo_identificacion:g.empleado_selected.tipo_identificacion||"",seguro:g.empleado_selected.seguro||g.empleado_selected.identificacion||"",conyuge_no_trabaja:g.empleado_selected.conyuge_no_trabaja}),x(),t.reset({seleccion:""}),n())}else{const b=await r(`/admin/contratos/${m}/${u}/add-contrato-planilla`,{method:"POST",data:D(w({},g.new_empleado),{negocio:m})});b.data&&(s({salario:"",decimo:d?"":0,vacaciones:0,preaviso:0,indemnizacion:0,impuesto_renta:0,id_contrato:b.data.id,nombre:g.new_empleado.nombre||"",apellido:g.new_empleado.apellido||"",complete_name:`${g.new_empleado.nombre} ${g.new_empleado.apellido}`,identificacion:g.new_empleado.identificacion||"",horas_extras:0,comisiones:0,tipo_identificacion:g.new_empleado.tipoIdentificacion||"",seguro:g.new_empleado.seguro||g.new_empleado.identificacion||"",conyuge_no_trabaja:g.new_empleado.conyuge_no_trabaja}),x(),t.reset({seleccion:""}),n())}}}},mo=I().shape({seleccion:M().trim().required("Favor seleccionar la forma de agregar al empleado").test("check","Favor seleccionar solo de la lista",t=>!!(t&&["new","old"].includes(t))),empleado_selected:I().nullable().when("seleccion",{is:"old",then:I().shape({id:ne().typeError("Favor seleccionar el empleado").positive("Favor seleccionar el empleado").integer("Favor seleccionar el empleado"),nombre:M().trim().required("Favor de ingresar el apellido").matches(te,"Favor ingresar solo letras del abecedario"),apellido:M().trim().required("Favor de ingresar el apellido").matches(te,"Favor ingresar solo letras del abecedario"),complete_name:M().trim().required("Favor de ingresar el apellido").matches(te,"Favor ingresar solo letras del abecedario"),identificacion:M().trim().required("Favor seleccionar el empleado"),fecha_ini:ue().transform((t,o)=>o===""?null:t).typeError("Favor seleccionar el empleado").nullable(!0).default(null).notRequired(),dv:M().typeError("Favor seleccionar el empleado").nullable(!0).notRequired().test("check","Favor ingresar un n\xFAmero de dos decimales",t=>!!(!t||t&&t.match(Xe)))}).typeError("Favor seleccionar el empleado")}),new_empleado:I().typeError("Favor ingresar el empleado").nullable().when("seleccion",{is:"new",then:I().shape({nombre:M().trim().required("Favor de ingresar el nombre").matches(te,"Favor ingresar solo letras del abecedario"),apellido:M().trim().required("Favor de ingresar el apellido").matches(te,"Favor ingresar solo letras del abecedario"),dv:M().trim().nullable(!0).notRequired().test("check","Favor ingresar un n\xFAmero de dos decimales",t=>!!(!t||t&&t.match(Xe))),tipoIdentificacion:M().trim().required("Favor de ingresar el tipo de identificaci\xF3n").test("is-identificacion","Favor de ingresar un tipo de identificaci\xF3n v\xE1lido: "+[...pe,"C\xE9dula No verificada"].join(", "),t=>[...pe,"C\xE9dula No verificada"].includes(t)),identificacion:M().trim().required("Favor de ingresar la c\xE9dula o pasaporte").matches(Ye,"Favor de ingresar solo n\xFAmeros, letras en may\xFAscula y/o guiones (-)"),seguro:M().trim().nullable(!0).notRequired().test("check-seguro","Favor de ingresar solo n\xFAmeros, letras en may\xFAscula y/o guiones (-)",t=>!!(!t||t&&new RegExp(Ye).test(t))),fecha_ini:ue().transform((t,o)=>o===""?null:t).typeError("Favor de seleccionar la fecha de inicio del empleado").nullable(!0).default(null).notRequired()})})}),uo=()=>{var u,c,d,x,N,g,b,v,C,A,T,P,z,$,y,q;const t=E(),{register:o,formState:r,control:n,setValue:a}=t,{errors:s}=r,m=R({control:n,name:"new_empleado.conyuge_no_trabaja"});return l(k,{spacing:1,style:{marginTop:10},children:[e(io,{control:n,label:"Tipo de identificaci\xF3n",options:[...pe,"C\xE9dula No verificada"],error:!!((u=s==null?void 0:s.new_empleado)!=null&&u.tipoIdentificacion),helperText:(d=(c=s==null?void 0:s.new_empleado)==null?void 0:c.tipoIdentificacion)==null?void 0:d.message,name:"new_empleado.tipoIdentificacion",required:!0}),e(Y,w({label:"Nombre",fullWidth:!0,error:!!((x=s==null?void 0:s.new_empleado)!=null&&x.nombre),helperText:(g=(N=s==null?void 0:s.new_empleado)==null?void 0:N.nombre)==null?void 0:g.message,required:!0},o("new_empleado.nombre"))),e(Y,w({label:"Apellido",fullWidth:!0,error:!!((b=s==null?void 0:s.new_empleado)!=null&&b.apellido),helperText:(C=(v=s==null?void 0:s.new_empleado)==null?void 0:v.apellido)==null?void 0:C.message,required:!0},o("new_empleado.apellido"))),e(Y,w({label:"Identificaci\xF3n",fullWidth:!0,error:!!((A=s==null?void 0:s.new_empleado)!=null&&A.identificacion),helperText:(z=(P=(T=s==null?void 0:s.new_empleado)==null?void 0:T.identificacion)==null?void 0:P.message)!=null?z:"C\xE9dula o Pasaporte",required:!0},o("new_empleado.identificacion"))),e(Y,w({label:"Seguro social",fullWidth:!0,error:!!(($=s==null?void 0:s.new_empleado)!=null&&$.seguro),helperText:(q=(y=s==null?void 0:s.new_empleado)==null?void 0:y.seguro)==null?void 0:q.message},o("new_empleado.seguro"))),e(Vo,{control:e(co,{checked:m===4,defaultChecked:m===4,onChange:G=>{a("new_empleado.conyuge_no_trabaja",G.target.checked?4:1)}}),label:"Casado(a) y c\xF3nyuge no trabaja"})]})},Gt=()=>{const{mainNegocioId:t,clienteId:o}=i.exports.useContext(Q),{control:r,formState:n}=E(),{errors:a}=n;return e(Bo,{control:r,name:"empleado_selected",render:({field:s})=>{var m,u,c,d,x;return e(Wo,D(w({},s),{urlFetch:`/admin/contratos/${t}/${o}/input-planilla`,enableFirst:!0,onChange:(N,g)=>s.onChange(g),inputProps:{label:"Empleado",helperText:(u=(m=a==null?void 0:a.empleado_selected)==null?void 0:m.id)==null?void 0:u.message,error:!!((x=(d=(c=n.errors)==null?void 0:c.empleado_selected)==null?void 0:d.id)!=null&&x.message)},fullWidth:!0,isOptionEqualToValue:(N,g)=>N.id===g.id,getOptionLabel:N=>N.complete_name||"",renderOption:(N,g,{selected:b})=>l(Go,D(w({},N),{style:{textOverflow:"ellipsis",whiteSpace:"nowrap"},children:[e(co,{icon:e(jo,{}),checkedIcon:e(Lo,{}),style:{marginRight:8},checked:b}),l("div",{style:{display:"flex",flexDirection:"column",textTransform:"uppercase"},children:[l(S,{variant:"body1",children:[g.nombre," ",g.apellido]}),e(S,{variant:"body2",children:g.identificacion})]})]}))}))}})},Ut=()=>{var a;const{control:t,formState:o}=E(),{errors:r}=o,n=R({control:t,name:"seleccion"});return l(f,{children:[e(io,{label:"Selecci\xF3n",options:["Insertar nuevo empleado","Empleado de la lista actual de contratos"],values:["new","old"],error:!!(r!=null&&r.seleccion),helperText:(a=r==null?void 0:r.seleccion)==null?void 0:a.message,name:"seleccion",required:!0}),n==="old"&&e("div",{style:{marginTop:10},children:e(Gt,{})}),n==="new"&&e(uo,{})]})},Ze=()=>{const t=i.exports.useContext(Q),{modalAgregarContrato:o}=t,{modalState:r,setHide:n}=o,a=ae({mode:"all",resolver:re(mo)}),s=J(),{handleAppenContrato:m}=Wt(a,s),[,,,u,,c]=s,d=i.exports.useCallback(()=>{n(),c(),a.reset({seleccion:""})},[]);return e(W,{state:r,title:"Agregar Empleado",setHide:()=>d(),cancelBotton:{text:"Cerrar",actionFunction:()=>d()},actionButton:{text:"Agregar",actionFunction:a.handleSubmit(m)},children:l(ce,D(w({},a),{children:[u&&e(le,{severity:"error",variant:"outlined",sx:{width:"100%",mb:2},children:u==null?void 0:u.message}),e(Ut,{})]}))})},Jt=t=>{const{reset:o}=t,r=i.exports.useContext(de),{negocioContrato:n,setNullNegocioContrato:a}=r,{control:s}=E(),m=R({control:s,name:"negocios"}),[u,c,d,x,,N]=J(),{update:g}=i.exports.useContext(Q);i.exports.useEffect(()=>{(()=>{if(n){const{negocioIndex:A,contratoIndex:T}=n,P=m[A].contratos[T];o({seleccion:"new",new_empleado:D(w({},P),{tipoIdentificacion:P.tipo_identificacion})})}else o({seleccion:"new",new_empleado:{}})})()},[n]);const b=C=>{const{negocioIndex:A,contratoIndex:T}=n,P=m[A].contratos[T];c(`/admin/contratos/${P.id_contrato}/edit-planilla`,{method:"POST",data:C.new_empleado}).then(z=>{if(z.data){const $=C.new_empleado,y=P;y.apellido=$.apellido||"",y.nombre=$.nombre||"",y.complete_name=`${$.nombre} ${$.apellido}`,y.tipo_identificacion=$.tipoIdentificacion||"",y.identificacion=$.identificacion||"",y.seguro=$.seguro||"",y.conyuge_no_trabaja=$.conyuge_no_trabaja,g(T,w({},y)),o({seleccion:"new",new_empleado:{}}),a(),N()}})};return{handleSetHide:i.exports.useCallback(()=>{a(),N(),o({seleccion:"new",new_empleado:{}})},[]),onSubmit:b,isLoading:u,response:d,error:x}},Kt=()=>{const t=i.exports.useContext(de),{negocioContrato:o}=t,r=ae({mode:"all",resolver:re(mo)}),{handleSubmit:n}=r,a=Jt(r),{handleSetHide:s,onSubmit:m,isLoading:u}=a,{response:c,error:d}=a;return l(W,{state:o!==null,setHide:()=>s(),title:"Editar Empleado",actionButton:{text:"Guardar",actionFunction:n(m),isLoading:u},children:[(c||d)&&e(le,{variant:"outlined",severity:c?"success":"error",children:(c==null?void 0:c.message)||(d==null?void 0:d.message)}),e(ce,D(w({},r),{children:e(uo,{})}))]})},Qt=t=>{const{fieldsNegocios:o}=i.exports.useContext(K),{remove:r}=o,{negocioIndex:n}=t,{control:a}=E(),s=R({control:a,name:`negocios.${n}`});return s.contratos&&s.contratos.length>0?l(f,{children:[e(jt,{negocioIndex:n}),e(Lt,{negocioIndex:n}),e(Ze,{}),e(Kt,{})]}):l(le,{severity:"error",action:n!==0&&n!=="0"&&e(ie,{variant:"contained",color:"error",size:"small",onClick:()=>r(Number(n)),startIcon:e(ro,{}),children:"Remover negocio"}),children:[e(S,{fontWeight:"bold",children:"Favor ingresar al menos un empleado"}),e(Ze,{})]})},fe=i.exports.createContext({}),Xt=({children:t})=>{const o=U();return e(fe.Provider,{value:{modalAgregarNegocio:o},children:t})},Yt="_divBtnAgregar_1mbg8_1",Zt="_btnAgregar_1mbg8_9";var me={divBtnAgregar:Yt,btnAgregar:Zt};const en=()=>{const{modalAgregarNegocio:t}=i.exports.useContext(fe),{setOpen:o}=t,{modalAgregarContrato:r}=i.exports.useContext(Q),{setOpen:n}=r;return l("div",{className:me.divBtnAgregar,children:[e(ie,{className:me.btnAgregar,variant:"contained",size:"small",onClick:()=>n(),startIcon:e(So,{}),children:"Agregar empleado"}),e(ie,{className:me.btnAgregar,variant:"contained",color:"success",size:"small",onClick:()=>o(),startIcon:e(Uo,{}),children:"Agregar negocio"})]})},on=I().shape({negocio_cobrar:I().shape({id:ne().typeError("Favor ingresar el id").integer("Favor ingresar el negocio").positive("Favor ingresar el negocio").required("Favor ingresar el id")}).typeError("Favor seleccionar un negocio").required("Favor seleccionar un negocio")}),tn=(t,o)=>{const{fieldsNegocios:r}=i.exports.useContext(K),{append:n}=r,{control:a}=E(),s=R({control:a,name:"negocios"}),m=()=>{o(),t.reset({})};return{handleAppendNegocio:c=>{s.findIndex(x=>Number(x.id_negocio)===Number(c.negocio_cobrar.id))===-1?(n({id_negocio:c.negocio_cobrar.id,id_cliente:c.negocio_cobrar.id_cliente,nombre:c.negocio_cobrar.nombre_negocio,tipo:c.negocio_cobrar.tipo,contratos:[]}),m()):t.setError("negocio_cobrar",{message:"El negocio ya existe en la planilla actual"})},handleSetHide:m}},nn=()=>{const{modalAgregarNegocio:t}=i.exports.useContext(fe),{modalState:o,setHide:r}=t,n=ae({resolver:re(on)}),{handleAppendNegocio:a,handleSetHide:s}=tn(n,r);return e(ce,D(w({},n),{children:e(W,{state:o,title:"Agregar Negocio",setHide:()=>s(),cancelBotton:{text:"Cerrar",actionFunction:()=>s()},actionButton:{text:"Agregar",actionFunction:n.handleSubmit(a)},children:e(Jo,{name:"negocio_cobrar",label:"Negocio"})})}))},po=i.exports.createContext({}),an=({children:t,clienteId:o,mainNegocioId:r})=>{const n=U();return e(po.Provider,{value:{modalSaveData:n,clienteId:o,mainNegocioId:r},children:t})},rn="_divSaveData_28j6j_1";var sn={divSaveData:rn};const cn=()=>{const{id:t}=ee(),{fetcherSaveData:o}=i.exports.useContext(K),[,r]=o;return{handleSaveData:a=>{r(`/admin/planillas/${t}/edit`,{method:"POST",data:a})}}},ln=()=>{const{fetcherSaveData:t}=i.exports.useContext(K),{modalSaveData:o}=i.exports.useContext(po),{modalState:r,setHide:n,setOpen:a}=o,{handleSubmit:s,formState:m}=E(),{errors:u}=m,{handleSaveData:c}=cn(),[d,,x,N]=t,[,,,g]=i.exports.useContext(F),{setEditing:b}=i.exports.useContext(H),v=i.exports.useCallback(()=>{n(),x&&!N&&(b(!1),g())},[x,N]);return l(f,{children:[e(ge,{}),e("div",{className:sn.divSaveData,children:e(ie,{variant:"outlined",onClick:()=>a(),children:"Guardar"})}),e(W,{state:r,setHide:()=>v(),title:"\xA1Atenci\xF3n!",type:x?"SUCCESS":"ERROR",cancelBotton:{text:"Cerrar",actionFunction:()=>v()},actionButton:!u.negocios&&(!x||N)?{text:"Guardar",actionFunction:s(c),isLoading:d}:void 0,children:x?l(f,{children:[x.message,"."]}):u.negocios?e(f,{children:"Se encontraron errores en el formulario. Favor corregir antes de avanzar."}):!u.negocios&&!N?e(f,{children:"\xBFRealmente desea guardar los datos?"}):e(f,{children:N==null?void 0:N.message})})]})},dn=()=>{const t=i.exports.useContext(K),{fieldsNegocios:o,isDecimo:r}=t,{mainNegocioId:n,clienteId:a}=t,{fields:s}=o;return l(Xt,{children:[e(Z,{variant:"outlined",className:h.paperTables,children:l(k,{direction:"column",spacing:1,marginTop:1,margin:1,children:[s.map((m,u)=>l(Z,{variant:"outlined",children:[l(S,{variant:"h5",textTransform:"uppercase",fontWeight:"bold",padding:1,color:u===0?"red":"darkorange",children:[m.tipo," ",m.nombre]}),e(Ot,{mainNegocioId:s[0].id_negocio,clienteId:s[0].id_cliente,negocioIndex:u,isDecimo:r,children:l(Vt,{children:[e(Qt,{negocioIndex:u}),e(en,{})]})})]},`${u}`)),e(Z,{variant:"outlined",className:h.paperNotas,children:l(k,{direction:"column",spacing:1,children:[e(S,{variant:"h5",children:"Notas:"}),e(ge,{}),e(Ko,{name:"notas",height:300})]})}),e(an,{mainNegocioId:n,clienteId:a,children:e(ln,{})})]})}),e(nn,{})]})},mn=()=>e(ft,{children:e(dn,{})}),un=I({edit_token:M().trim().required("Favor ingresar la contrase\xF1a")}),pn=()=>{var T;const{id:t}=ee(),{modalEditar:o,setEditing:r}=i.exports.useContext(H),{modalState:n,setHide:a}=o,{register:s,formState:m,handleSubmit:u,reset:c}=ae({mode:"all",resolver:re(un)}),{errors:d}=m,x=J(),[N,g,b,v,,C]=x,A=i.exports.useCallback(()=>{a(),b&&r(!0),C(),c({edit_token:""})},[b,v]);return e(W,{state:n,setHide:A,type:b?"SUCCESS":"ERROR",title:b?"\xA1Atenci\xF3n!":"Favor ingresar la contrase\xF1a",cancelBotton:{text:b?"Cerrar":"Cancelar",actionFunction:A},actionButton:b?void 0:{text:"V\xE1lidar",actionFunction:u(async P=>{c(),await g(`/admin/planillas/${t}/check-token`,{method:"POST",data:P})}),isLoading:N},children:l("div",{style:{display:"flex",flexDirection:"column"},children:[(b||v)&&l(le,{variant:"outlined",severity:b?"success":"error",style:{marginBottom:10},children:[b&&!v&&e(f,{children:b.message}),v&&e(f,{children:v.message})]}),!b&&e(Y,w({label:"Contrase\xF1a",fullWidth:!0,required:!0,helperText:(T=d==null?void 0:d.edit_token)==null?void 0:T.message,error:!!(d!=null&&d.edit_token),autoFocus:!0,focused:!0},s("edit_token")))]})})};var _e={},hn=to.exports;Object.defineProperty(_e,"__esModule",{value:!0});var ho=_e.default=void 0,gn=hn(oo),xn=no,bn=(0,gn.default)((0,xn.jsx)("path",{d:"M16 1H4c-1.1 0-2 .9-2 2v14h2V3h12V1zm3 4H8c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h11c1.1 0 2-.9 2-2V7c0-1.1-.9-2-2-2zm0 16H8V7h11v14z"}),"ContentCopy");ho=_e.default=bn;const Nn=()=>{const{id:t}=ee(),{modalGenerarPassword:o}=i.exports.useContext(H),{modalState:r,setHide:n}=o,a=J(),[s,m,u,c,,d]=a,x=i.exports.useCallback(()=>{n(),d()},[]);return i.exports.useEffect(()=>{(()=>{r?m(`/admin/planillas/${t}/generate-token`,{method:"POST"}):d()})()},[r]),l(W,{state:r,setHide:x,cancelBotton:{text:"Cerrar",actionFunction:x,isLoading:s},actionButton:!u&&c?{text:"Reintentar",actionFunction:()=>{d(),m(`/admin/planillas/${t}/generate-token`,{method:"POST"})}}:void 0,title:"\xA1Atenci\xF3n!",type:u?"SUCCESS":"ERROR",body:c==null?void 0:c.message,children:[s&&e(eo,{}),!s&&u&&e("div",{style:{display:"flex",flexDirection:"row",justifyContent:"center"},children:e(Y,{InputProps:{readOnly:!0,endAdornment:e(Qo,{position:"end",children:e(so,{onClick:()=>navigator.clipboard.writeText(u.token),children:e(ho,{})})})},value:u==null?void 0:u.token})})]})},fn=()=>{const{modalDownload:t,fetchDownload:o}=i.exports.useContext(H),{modalState:r,setHide:n}=t,[a,,s,m,,u]=o,c=i.exports.useCallback(()=>{n(),u()},[]);return l(f,{children:[e(Xo,{open:a}),e(W,{state:r,title:"\xA1Atenci\xF3n!",type:s?"SUCCESS":"ERROR",setHide:()=>c(),cancelBotton:{text:"Cerrar",actionFunction:()=>c()},children:m?m.message:l(f,{children:["\xA1Archivo descargado correctamente!. ",e("br",{})," \xA1Si el archivo se envi\xF3 al ",e("strong",{children:"SIPE"}),", recuerde marcar la planilla como enviada!"]})})]})},_n=()=>{const[,t,,,o]=i.exports.useContext(F),{modalSend:r}=i.exports.useContext(H),{modalState:n,setHide:a}=r,s=J(),[m,u,c,d,,x]=s,{id:N}=ee(),g=i.exports.useCallback(()=>{a(),x(),c&&o(D(w({},t),{fecha_send_sipe:"2020-01-01"}))},[c,d]);return e(f,{children:e(W,{state:n,setHide:()=>g(),title:"\xA1Atenci\xF3n!",type:c?"SUCCESS":"ERROR",body:c?c.message:d?d.message:"\xBFRealmente desea marcar la planilla como formarto SIPE enviado?",actionButton:c?void 0:{text:"Ok",actionFunction:()=>{u(`/admin/planillas/${N}/send`,{method:"POST",data:{name:"sipe"}})},isLoading:m},cancelBotton:{text:c?"Cerrar":"Cancelar",actionFunction:()=>g()}})})},vn=()=>{const{editing:t}=i.exports.useContext(H),[,o,r]=i.exports.useContext(F);return l(f,{children:[!o&&!r&&e(eo,{}),!o&&r&&e($o,{text:r.message}),o&&!r&&l(k,{direction:"column",spacing:1,children:[e(Zo,{}),t?e(mn,{}):l(f,{children:[e(at,{}),e(lt,{}),e(bt,{}),e(pn,{}),e(fn,{}),e(Nn,{}),e(_n,{})]})]})]})},Ya=()=>e(Yo,{children:l(gt,{children:[e(_o,{message:"Planilla"}),e(vn,{})]})});export{Ya as default};
